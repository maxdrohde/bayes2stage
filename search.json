[{"path":"https://maxdrohde.github.io/bayes2stage/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 bayes2stage authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with bayes2stage","text":"Two-stage designs cost-effective approach studies key covariate expensive measure. first stage, inexpensive outcome data collected subjects. second stage, expensive covariate measured strategically selected subset. bayes2stage package provides tools : Simulating longitudinal data random effects Designing second-stage sample using outcome-dependent BLUP-dependent sampling Fitting Bayesian mixed effects models impute missing covariate values","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"example-workflow","dir":"Articles","previous_headings":"","what":"Example Workflow","title":"Getting Started with bayes2stage","text":"First, simulate longitudinal data subject repeated measurements time: data includes: y: outcome measured time point t: time (scaled 0-1) x: expensive covariate (constant within subject) z: cheap covariate (constant within subject) id: subject identifier Now select subjects x measured. Outcome-dependent sampling (ODS) selects subjects based estimated trajectories, oversampling tails: subjects selected, x set NA. Stan-based model jointly estimates outcome model imputes missing x values:","code":"library(bayes2stage)  set.seed(123) data <- generate_data(   N = 1000,                    # 1000 subjects  M = 5,                       # 5 time points each   x_dist = \"normal\",           # x is continuous   beta_x = 1,                  # effect of x on outcome   beta_t = 2,                  # effect of time   beta_t_x_interaction = 0.3,  # x modifies the trajectory   rand_intercept_sd = 3,       # subject-level intercept variation   rand_slope_sd = 1            # subject-level slope variation )  head(data) stage2_data <- ods_design(   data,   sampling_type = \"slope\",     # select based on OLS slopes   cutoff_low = 0.25,           # bottom 25% = \"low\" stratum   cutoff_high = 0.75,          # top 25% = \"high\" stratum   n_sampled = 200,             # sample 200 subjects total   prop_low = 0.4,              # 40% from low stratum   prop_middle = 0.2,           # 20% from middle   prop_high = 0.4              # 40% from high stratum )  # Check how many have x observed vs missing table(is.na(stage2_data$x)) fit <- fit_stan_model(   data = stage2_data,   main_model_covariates = c(\"x\", \"z\", \"t\"),   imputation_model_covariates = c(\"z\"),   imputation_distribution = \"normal\",   n_chains = 4,   iter_warmup = 1000,   iter_sampling = 1000,   parallel_chains = 4 ) # Parameter summaries fit$summary(variables = c(\"alpha\", \"beta_x\", \"beta_z\", \"beta_t\"))  # Trace plots for diagnostics mcmc_trace(fit)"},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"step-1-generate-data","dir":"Articles","previous_headings":"","what":"Step 1: Generate Data","title":"Getting Started with bayes2stage","text":"First, simulate longitudinal data subject repeated measurements time: data includes: y: outcome measured time point t: time (scaled 0-1) x: expensive covariate (constant within subject) z: cheap covariate (constant within subject) id: subject identifier","code":"library(bayes2stage)  set.seed(123) data <- generate_data(   N = 1000,                    # 1000 subjects  M = 5,                       # 5 time points each   x_dist = \"normal\",           # x is continuous   beta_x = 1,                  # effect of x on outcome   beta_t = 2,                  # effect of time   beta_t_x_interaction = 0.3,  # x modifies the trajectory   rand_intercept_sd = 3,       # subject-level intercept variation   rand_slope_sd = 1            # subject-level slope variation )  head(data)"},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"step-2-apply-a-sampling-design","dir":"Articles","previous_headings":"","what":"Step 2: Apply a Sampling Design","title":"Getting Started with bayes2stage","text":"Now select subjects x measured. Outcome-dependent sampling (ODS) selects subjects based estimated trajectories, oversampling tails: subjects selected, x set NA.","code":"stage2_data <- ods_design(   data,   sampling_type = \"slope\",     # select based on OLS slopes   cutoff_low = 0.25,           # bottom 25% = \"low\" stratum   cutoff_high = 0.75,          # top 25% = \"high\" stratum   n_sampled = 200,             # sample 200 subjects total   prop_low = 0.4,              # 40% from low stratum   prop_middle = 0.2,           # 20% from middle   prop_high = 0.4              # 40% from high stratum )  # Check how many have x observed vs missing table(is.na(stage2_data$x))"},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"step-3-fit-a-bayesian-model","dir":"Articles","previous_headings":"","what":"Step 3: Fit a Bayesian Model","title":"Getting Started with bayes2stage","text":"Stan-based model jointly estimates outcome model imputes missing x values:","code":"fit <- fit_stan_model(   data = stage2_data,   main_model_covariates = c(\"x\", \"z\", \"t\"),   imputation_model_covariates = c(\"z\"),   imputation_distribution = \"normal\",   n_chains = 4,   iter_warmup = 1000,   iter_sampling = 1000,   parallel_chains = 4 )"},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"step-4-examine-results","dir":"Articles","previous_headings":"","what":"Step 4: Examine Results","title":"Getting Started with bayes2stage","text":"","code":"# Parameter summaries fit$summary(variables = c(\"alpha\", \"beta_x\", \"beta_z\", \"beta_t\"))  # Trace plots for diagnostics mcmc_trace(fit)"},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"sampling-design-options","dir":"Articles","previous_headings":"","what":"Sampling Design Options","title":"Getting Started with bayes2stage","text":"package provides three sampling strategies:","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"supported-covariate-distributions","dir":"Articles","previous_headings":"","what":"Supported Covariate Distributions","title":"Getting Started with bayes2stage","text":"Choose imputation distribution based nature x:","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"alternative-acml-estimation","dir":"Articles","previous_headings":"","what":"Alternative: ACML Estimation","title":"Getting Started with bayes2stage","text":"frequentist analysis, use ascertainment-corrected maximum likelihood:","code":"acml_fit <- fit_acml_ods(   ods_df = stage2_data,   cutoff_low = 0.25,   cutoff_high = 0.75 )  acml_fit"},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"further-reading","dir":"Articles","previous_headings":"","what":"Further Reading","title":"Getting Started with bayes2stage","text":"Package documentation: ?fit_stan_model, ?ods_design, ?generate_data GitHub: https://github.com/maxdrohde/bayes2stage","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Maximilian Rohde. Author, maintainer.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Rohde M (2025). bayes2stage: Bayesian Analysis Two-Stage Designs Longitudinal Data. R package version 0.0.0.9000, https://github.com/maxdrohde/bayes2stage.","code":"@Manual{,   title = {bayes2stage: Bayesian Analysis of Two-Stage Designs with Longitudinal Data},   author = {Maximilian Rohde},   year = {2025},   note = {R package version 0.0.0.9000},   url = {https://github.com/maxdrohde/bayes2stage}, }"},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"bayes2stage","dir":"","previous_headings":"","what":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"Warning: package still developed. use current state. bayes2stage provides tools designing analyzing two-stage studies longitudinal data. designs, expensive covariate measured strategically selected subset subjects, Bayesian imputation recovers information subjects missing covariate data.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"Two-stage designs useful : key covariate expensive invasive measure (e.g., biomarkers, genetic tests) Longitudinal outcome data available subjects want maximize statistical efficiency minimizing measurement costs package supports three sampling strategies selecting subjects measure: ODS BDS designs oversample tails trajectory distribution, improving efficiency detecting covariate effects.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"","code":"# install.packages(\"devtools\") devtools::install_github(\"maxdrohde/bayes2stage\")"},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"id_1-generate-or-load-longitudinal-data","dir":"","previous_headings":"Workflow","what":"1. Generate or load longitudinal data","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"outcome model : yij=α+βxxi+βzzi+(βt+b1i)tij+βtxxitij+b0i+ϵijy_{ij} = \\alpha + \\beta_x x_i + \\beta_z z_i + (\\beta_t + b_{1i}) t_{ij} + \\beta_{tx} x_i t_{ij} + b_{0i} + \\epsilon_{ij} b0ib_{0i} b1ib_{1i} correlated random intercepts slopes.","code":"library(bayes2stage)  set.seed(123) data <- generate_data(   N = 1000,                    # subjects   M = 5,                       # time points per subject   x_dist = \"normal\",           # covariate distribution   beta_x = 1,                  # effect of x on outcome   beta_t_x_interaction = 0.3,  # x modifies the slope   rand_intercept_sd = 3,   rand_slope_sd = 1 )"},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"id_2-apply-a-two-stage-sampling-design","dir":"","previous_headings":"Workflow","what":"2. Apply a two-stage sampling design","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"Select 200 subjects stage 2, oversampling tails: Subjects selected x values set NA.","code":"stage2_data <- ods_design(   data,   sampling_type = \"slope\",     # sample based on estimated slopes   cutoff_low = 0.25,   cutoff_high = 0.75,   n_sampled = 200,   prop_low = 0.4,              # 40% from lowest quartile   prop_middle = 0.2,           # 20% from middle 50%   prop_high = 0.4              # 40% from highest quartile )"},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"id_3-fit-bayesian-model-with-imputation","dir":"","previous_headings":"Workflow","what":"3. Fit Bayesian model with imputation","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"Stan model jointly: Models longitudinal outcome random effects Imputes missing covariate values using observed covariates","code":"fit <- fit_stan_model(   data = stage2_data,   main_model_covariates = c(\"x\", \"z\", \"t\"),   imputation_model_covariates = c(\"z\"),   imputation_distribution = \"normal\",   n_chains = 4,   iter_warmup = 1000,   iter_sampling = 1000 )  # View results fit$summary(variables = c(\"beta_x\", \"beta_z\", \"beta_t\"))"},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"supported-covariate-distributions","dir":"","previous_headings":"","what":"Supported Covariate Distributions","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"package handles different covariate types specialized Stan models:","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"ascertainment-corrected-maximum-likelihood-acml","dir":"","previous_headings":"Alternative Estimation Methods","what":"Ascertainment-Corrected Maximum Likelihood (ACML)","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"frequentist analysis ODS designs:","code":"acml_results <- fit_acml_ods(   ods_df = stage2_data,   cutoff_low = 0.25,   cutoff_high = 0.75 )"},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"","code":"Rohde, M. (2024). bayes2stage: Bayesian Analysis of Two-Stage Designs. R package version 0.0.0.9000. https://github.com/maxdrohde/bayes2stage"},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"links","dir":"","previous_headings":"","what":"Links","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"GitHub Repository Bug Reports","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi1q.html","id":null,"dir":"Reference","previous_headings":"","what":"Ascertainment correction piece for univariate sampling — ACi1q","title":"Ascertainment correction piece for univariate sampling — ACi1q","text":"Calculate (yet log transformed) ascertainment correction univariate Q_i","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi1q.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ascertainment correction piece for univariate sampling — ACi1q","text":"","code":"ACi1q(cutpoints, SampProb, mu_q, sigma_q)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi1q.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ascertainment correction piece for univariate sampling — ACi1q","text":"cutpoints cutpoints defining sampling regions. (vector length 2) SampProb Sampling probabilities within region (vector length 3). mu_q scalar mean value Q_i distribution sigma_q scalar standard deviation Q_i distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi1q.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ascertainment correction piece for univariate sampling — ACi1q","text":"yet log transformed ascertainment correction","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi2q.html","id":null,"dir":"Reference","previous_headings":"","what":"Ascertainment correction piece for bivariate sampling — ACi2q","title":"Ascertainment correction piece for bivariate sampling — ACi2q","text":"Calculate (yet log transformed) ascertainment correction bivariate Q_i","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi2q.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ascertainment correction piece for bivariate sampling — ACi2q","text":"","code":"ACi2q(cutpoints, SampProb, mu_q, sigma_q)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi2q.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ascertainment correction piece for bivariate sampling — ACi2q","text":"cutpoints cutpoints defining sampling regions. (vector length 4: c(xlow, xhigh, ylow, yhigh)) SampProb Sampling probabilities within two sampling regions; central region outlying region (vector length 2). mu_q 2-vector mean value bivariate Q_i distribution. sigma_q 2 2 covariance matrix bivariate Q_i distribution.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi2q.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ascertainment correction piece for bivariate sampling — ACi2q","text":"yet log transformed ascertainment correction","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/CreateSubjectData.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a list of subject-specific data — CreateSubjectData","title":"Create a list of subject-specific data — CreateSubjectData","text":"Create list subject-specific data","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/CreateSubjectData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a list of subject-specific data — CreateSubjectData","text":"","code":"CreateSubjectData(id, y, x, z, Weights, SampProb, cutpoints, w.function)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/CreateSubjectData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a list of subject-specific data — CreateSubjectData","text":"id sum(n_i) vector subject ids y response vector x sum(n_i) p design matrix fixed effects z sum(n_i) 2 design matric random effects (intercept slope) Weights Subject specific sampling weights.  vector length sum(n_i).  used unless using weighted Likelihood SampProb matrix first dimension equal sum(n_i).   Sampling probabilities within region (bivariate Q_i: row vector length 2 c(central region, outlying region); univariate Q_i: row vector length 3 sampling probabilities region). subject n_i rows values. cutpoints matrix first dimension equal sum(n_i).  cutpoints define sampling regions (bivariate Q_i: row vector length 4 c(xlow, xhigh, ylow, yhigh); univariate Q_i: row vector length 2 c(k1,k2) define sampling regions, .e., low, middle, high).  subject n_i rows values. w.function sum(n_i) vector possible values include \"mean\" \"intercept\" \"slope\" \"bivar.\"  one unique value per subject","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC.Score2.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the gradient of the conditional likelihood for the univariate and bivariate sampling cases across all subjects (CheeseCalc=FALSE) or the cheese part of the sandwich estimator if CheeseCalc=TRUE. — LogLikeC.Score2","title":"Calculate the gradient of the conditional likelihood for the univariate and bivariate sampling cases across all subjects (CheeseCalc=FALSE) or the cheese part of the sandwich estimator if CheeseCalc=TRUE. — LogLikeC.Score2","text":"Calculate gradient conditional likelihood univariate bivariate sampling cases across subjects (CheeseCalc=FALSE) cheese part sandwich estimator CheeseCalc=TRUE.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC.Score2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the gradient of the conditional likelihood for the univariate and bivariate sampling cases across all subjects (CheeseCalc=FALSE) or the cheese part of the sandwich estimator if CheeseCalc=TRUE. — LogLikeC.Score2","text":"","code":"LogLikeC.Score2(   y,   x,   z,   w.function,   id,   beta,   sigma.vc,   rho.vc,   sigma.e,   cutpoints,   SampProb,   Weights,   CheeseCalc = FALSE )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC.Score2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the gradient of the conditional likelihood for the univariate and bivariate sampling cases across all subjects (CheeseCalc=FALSE) or the cheese part of the sandwich estimator if CheeseCalc=TRUE. — LogLikeC.Score2","text":"y response vector x sum(n_i) p design matrix fixed effects z sum(n_i) 2 design matric random effects (intercept slope) w.function sum(n_i) vector possible values include \"mean\" (mean response series), \"intercept\" (intercept regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[1,]), \"intercept1\"  (intercept regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[1,]). \"intercept2\" (second intercept regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[3,]), \"slope\" (slope regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[2,]), \"slope1\" (slope regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[2,]), \"slope2\" (second slope regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[4,]) \"bivar\" (intercept slope regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[c(1,2),]) \"mvints\" (first second intercepts bivariate regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[c(1,3),]) \"mvslps\" (first second slopes bivariate regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[c(1,3),]).  one unique value per subject id sum(n_i) vector subject ids beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution cutpoints matrix first dimension equal sum(n_i).  cutpoints define sampling regions (bivariate Q_i: row vector length 4 c(xlow, xhigh, ylow, yhigh); univariate Q_i: row vector length 2 c(k1,k2) define sampling regions, .e., low, middle, high).  subject n_i rows values. SampProb matrix first dimension equal sum(n_i).   Sampling probabilities within region (bivariate Q_i: row vector length 2 c(central region, outlying region); univariate Q_i: row vector length 3 sampling probabilities region). subject n_i rows values. Weights Subject specific sampling weights.  vector length sum(n_i).  used unless using weighted Likelihood CheeseCalc FALSE, function returns gradient conditional log likelihood across subjects.  TRUE, cheese part sandwich esitmator calculated.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC.Score2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the gradient of the conditional likelihood for the univariate and bivariate sampling cases across all subjects (CheeseCalc=FALSE) or the cheese part of the sandwich estimator if CheeseCalc=TRUE. — LogLikeC.Score2","text":"CheeseCalc=FALSE, gradient conditional log likelihood.  CheeseCalc=TRUE, cheese part sandwich estimator calculated.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC2.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the conditional likelihood for the univariate and bivariate sampling cases across all subjects (Keep.liC=FALSE) or the subject specific contributions to the conditional likelihood along with the log-transformed ascertainment correction for multiple imputation (Keep.liC=TRUE). — LogLikeC2","title":"Calculate the conditional likelihood for the univariate and bivariate sampling cases across all subjects (Keep.liC=FALSE) or the subject specific contributions to the conditional likelihood along with the log-transformed ascertainment correction for multiple imputation (Keep.liC=TRUE). — LogLikeC2","text":"Calculate conditional likelihood univariate bivariate sampling cases across subjects (Keep.liC=FALSE) subject specific contributions conditional likelihood along log-transformed ascertainment correction multiple imputation (Keep.liC=TRUE).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the conditional likelihood for the univariate and bivariate sampling cases across all subjects (Keep.liC=FALSE) or the subject specific contributions to the conditional likelihood along with the log-transformed ascertainment correction for multiple imputation (Keep.liC=TRUE). — LogLikeC2","text":"","code":"LogLikeC2(   y,   x,   z,   w.function,   id,   beta,   sigma.vc,   rho.vc,   sigma.e,   cutpoints,   SampProb,   Weights,   Keep.liC = FALSE )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the conditional likelihood for the univariate and bivariate sampling cases across all subjects (Keep.liC=FALSE) or the subject specific contributions to the conditional likelihood along with the log-transformed ascertainment correction for multiple imputation (Keep.liC=TRUE). — LogLikeC2","text":"y response vector x sum(n_i) p design matrix fixed effects z sum(n_i) q design matrix random effects w.function sum(n_i) vector possible values include \"mean\" \"intercept\" \"slope\" \"bivar.\"  one unique value per subject id sum(n_i) vector subject ids beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution cutpoints matrix first dimension equal sum(n_i).  cutpoints define sampling regions (bivariate Q_i: row vector length 4 c(xlow, xhigh, ylow, yhigh); univariate Q_i: row vector length 2 c(k1,k2) define sampling regions, .e., low, middle, high).  subject n_i rows values. SampProb matrix first dimension equal sum(n_i).   Sampling probabilities within region (bivariate Q_i: row vector length 2 c(central region, outlying region); univariate Q_i: row vector length 3 sampling probabilities region). subject n_i rows values. Weights Subject specific sampling weights.  vector length sum(n_i).  used unless using weighted Likelihood Keep.liC FALSE, function returns conditional log likelihood across subjects.  TRUE, subject specific contributions exponentiated subject specific ascertainment corrections returned list.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the conditional likelihood for the univariate and bivariate sampling cases across all subjects (Keep.liC=FALSE) or the subject specific contributions to the conditional likelihood along with the log-transformed ascertainment correction for multiple imputation (Keep.liC=TRUE). — LogLikeC2","text":"Keep.liC=FALSE, conditional log likelihood.  Keep.liC=TRUE, two-element list contains subject specific likelihood contributions exponentiated ascertainment corrections.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeCAndScore2.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the ascertainment corrected log likelihood and score — LogLikeCAndScore2","title":"Calculate the ascertainment corrected log likelihood and score — LogLikeCAndScore2","text":"Calculate ascertainment corrected log likelihood score","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeCAndScore2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the ascertainment corrected log likelihood and score — LogLikeCAndScore2","text":"","code":"LogLikeCAndScore2(   params,   y,   x,   z,   id,   w.function,   cutpoints,   SampProb,   Weights,   ProfileCol = NA,   Keep.liC = FALSE )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeCAndScore2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the ascertainment corrected log likelihood and score — LogLikeCAndScore2","text":"params parameter vector c(beta, log(sigma0), log(sigma1), rho, sigmae) y response vector x sum(n_i) p design matrix fixed effects z sum(n_i) 2 design matric random effects (intercept slope) id sum(n_i) vector subject ids w.function sum(n_i) vector possible values include \"mean\" (mean response series), \"intercept\" (intercept regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[1,]), \"intercept1\"  (intercept regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[1,]). \"intercept2\" (second intercept regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[3,]), \"slope\" (slope regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[2,]), \"slope1\" (slope regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[2,]), \"slope2\" (second slope regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[4,]) \"bivar\" (intercept slope regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[c(1,2),]) \"mvints\" (first second intercepts bivariate regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[c(1,3),]) \"mvslps\" (first second slopes bivariate regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[c(1,3),]).  one unique value per subject cutpoints matrix first dimension equal sum(n_i).  cutpoints define sampling regions (bivariate Q_i: row vector length 4 c(xlow, xhigh, ylow, yhigh); univariate Q_i: row vector length 2 c(k1,k2) define sampling regions, .e., low, middle, high).  subject n_i rows values. SampProb matrix first dimension equal sum(n_i).   Sampling probabilities within region (bivariate Q_i: row vector length 2 c(central region, outlying region); univariate Q_i: row vector length 3 sampling probabilities region). subject n_i rows values. Weights Subject specific sampling weights.  vector length sum(n_i).  used unless using weighted Likelihood ProfileCol column number(s) want fixed value param.  Maimizing log likelihood parameters fixing columns values params[ProfileCol] Keep.liC TRUE outputs subject specific conditional log lileihoods used imputation procedure described AOAS paper keep z sum(n_i) 2 design matric random effects (intercept slope)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeCAndScore2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the ascertainment corrected log likelihood and score — LogLikeCAndScore2","text":"conditional log likelihood \"gradient\" attribute (Keep.liC=FALSE) subject specific contributions conditional likelihood Keep.liC=TRUE).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeiC2.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the ss contributions to the conditional likelihood for the univariate and bivariate sampling cases. — LogLikeiC2","title":"Calculate the ss contributions to the conditional likelihood for the univariate and bivariate sampling cases. — LogLikeiC2","text":"Calculate ss contributions conditional likelihood univariate bivariate sampling cases.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeiC2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the ss contributions to the conditional likelihood for the univariate and bivariate sampling cases. — LogLikeiC2","text":"","code":"LogLikeiC2(subjectData, beta, sigma.vc, rho.vc, sigma.e)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeiC2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the ss contributions to the conditional likelihood for the univariate and bivariate sampling cases. — LogLikeiC2","text":"subjectData list containing: yi, xi, zi, Weights., w.function., SampProb., cutpoints.beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeiC2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the ss contributions to the conditional likelihood for the univariate and bivariate sampling cases. — LogLikeiC2","text":"ss contributions conditional log likelihood.  internal function used LogLikeC2","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/acml.lmem2.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope) — acml.lmem2","title":"Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope) — acml.lmem2","text":"Fitting function: ACML WL linear mixed effects model (random intercept slope)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/acml.lmem2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope) — acml.lmem2","text":"","code":"acml.lmem2(   formula.fixed,   formula.random,   data,   id,   w.function = \"mean\",   InitVals,   cutpoints,   SampProb,   Weights,   ProfileCol = NA )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/acml.lmem2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope) — acml.lmem2","text":"formula.fixed formula fixed effects (form y~x) formula.random formula random effects (form ~z).  Right now model fits random intercept slope models. data data frame contain everything formula.fixed, formula.random, id, Weights.  include: w.function, cutpoints, SampProb id sum(n_i) vector subject ids (variable contained data) w.function sum(n_i) vector possible values include \"mean\" (mean response series), \"intercept\" (intercept regression Yi ~ zi zi design matrix random effects (solve(t.zi* zi) * t.zi)[1,]), \"intercept1\"  (intercept regression Yi ~ zi zi design matrix random effects (solve(t.zi * zi) * t.zi)[1,]). \"intercept2\" (second intercept regression Yi ~ InitVals starting values c(beta, log(sigma0), log(sigma1), log((1+rho)/(1-rho)), log(sigmae)) cutpoints matrix first dimension equal sum(n_i).  cutpoints define sampling regions individual subjects.  using low, medium, high, sampling scheme, sum(n_i) 2 matrix must distinct object contained dat dataframe.  row vector length 2 c(k1,k2) define sampling regions, .e., low, middle, high.  using square doughnut design sum(n_i) 4 matrix (var1lower, var1upper, var2lower, var2upper). subject n_i rows values. SampProb matrix first dimension equal sum(n_i).   Sampling probabilities within region. low medium high sampling, row vector length 3 sampling probabilities region. bivariate stratum sampling row vector length 2 sampling probabilities inner outer strata. subject n_i rows values.  data. Weights Subject specific sampling weights.  vector length sum(n_i).  variable data dataframe. used IPWL.  Note IPWL, use robcov (robust variances) covar.  IPWL, must vectors 1s. ProfileCol column number(s) want fixed value param.  Maximizing log likelihood parameters fixing columns values InitVals[ProfileCol]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/acml.lmem2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope) — acml.lmem2","text":"Ascertainment corrected Maximum likelihood: Ests, covar, LogL, code, robcov","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/bayes2stage-package.html","id":null,"dir":"Reference","previous_headings":"","what":"bayes2stage: Bayesian Analysis of Two-Stage Designs with Longitudinal Data — bayes2stage-package","title":"bayes2stage: Bayesian Analysis of Two-Stage Designs with Longitudinal Data — bayes2stage-package","text":"Tools designing analyzing two-stage studies longitudinal data. Supports outcome-dependent sampling (ODS) BLUP-dependent sampling (BDS) designs expensive covariates measured subset subjects. Bayesian model fitting uses 'Stan' via 'instantiate' package mixed effects models imputation. Also provides ascertainment-corrected maximum likelihood (ACML) estimation.","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/reference/bayes2stage-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"bayes2stage: Bayesian Analysis of Two-Stage Designs with Longitudinal Data — bayes2stage-package","text":"Maintainer: Maximilian Rohde maxdrohde@gmail.com (ORCID)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/bds_design.html","id":null,"dir":"Reference","previous_headings":"","what":"Set x to missing based on an BDS design — bds_design","title":"Set x to missing based on an BDS design — bds_design","text":"Set x missing based BDS design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/bds_design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set x to missing based on an BDS design — bds_design","text":"","code":"bds_design(   data,   fixed_effects_formula,   sampling_type,   cutoff_high,   cutoff_low,   n_sampled,   prop_high,   prop_middle,   prop_low )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/bds_design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set x to missing based on an BDS design — bds_design","text":"data Dataset use fixed_effects_formula Formula fixed-effects fitting model estimate BLUPs sampling_type type sampling? \"intercept\" \"slope\" cutoff_high quantile use cutoff High category cutoff_low quantile use cutoff Low category n_sampled many subjects sampled? prop_high proportion sample High category? prop_middle proportion sample Middle category? prop_low proportion sample Low category?","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/bds_design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set x to missing based on an BDS design — bds_design","text":"dataset x values selected based BDS design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/cantor_seed.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a unique seed from two indices using Cantor pairing — cantor_seed","title":"Generate a unique seed from two indices using Cantor pairing — cantor_seed","text":"Uses Cantor pairing function generate unique integer seed two positive integer indices. Useful reproducible simulations (, j) combination needs unique seed.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/cantor_seed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a unique seed from two indices using Cantor pairing — cantor_seed","text":"","code":"cantor_seed(i, j)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/cantor_seed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a unique seed from two indices using Cantor pairing — cantor_seed","text":"First positive integer index j Second positive integer index","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/cantor_seed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a unique seed from two indices using Cantor pairing — cantor_seed","text":"unique integer seed","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/cantor_seed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a unique seed from two indices using Cantor pairing — cantor_seed","text":"","code":"cantor_seed(1, 1) #> [1] 4 cantor_seed(5, 10) #> [1] 130"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/check_cols.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for required columns in a data frame — check_cols","title":"Check for required columns in a data frame — check_cols","text":"Validates data frame contains required columns.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/check_cols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for required columns in a data frame — check_cols","text":"","code":"check_cols(data, required_cols)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/check_cols.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for required columns in a data frame — check_cols","text":"data data frame check required_cols character vector required column names","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/check_cols.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for required columns in a data frame — check_cols","text":"Invisibly returns TRUE columns present; otherwise throws error","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/extract_gamma_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract gamma matrix from posterior draws — extract_gamma_matrix","title":"Extract gamma matrix from posterior draws — extract_gamma_matrix","text":"Extract gamma matrix posterior draws","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/extract_gamma_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract gamma matrix from posterior draws — extract_gamma_matrix","text":"","code":"extract_gamma_matrix(draws, draw_idx = NULL)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/extract_gamma_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract gamma matrix from posterior draws — extract_gamma_matrix","text":"draws Posterior draws data frame draw_idx Indices draws use","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/extract_gamma_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract gamma matrix from posterior draws — extract_gamma_matrix","text":"Matrix gamma values (n_draws x n_covariates)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_acml_ods.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit ACML model for outcome-dependent sampling — fit_acml_ods","title":"Fit ACML model for outcome-dependent sampling — fit_acml_ods","text":"Fits ascertainment-corrected maximum likelihood model ODS designs.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_acml_ods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit ACML model for outcome-dependent sampling — fit_acml_ods","text":"","code":"fit_acml_ods(ods_df, cutoff_low, cutoff_high)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_acml_ods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit ACML model for outcome-dependent sampling — fit_acml_ods","text":"ods_df Data frame ODS sampling cutoff_low Lower cutoff value sampling regions cutoff_high Upper cutoff value sampling regions","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_acml_ods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit ACML model for outcome-dependent sampling — fit_acml_ods","text":"data frame parameter estimates confidence intervals","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_stan_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a Bayesian two-stage model using Stan — fit_stan_model","title":"Fit a Bayesian two-stage model using Stan — fit_stan_model","text":"Fits mixed effects model imputation using Stan via instantiate package.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_stan_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a Bayesian two-stage model using Stan — fit_stan_model","text":"","code":"fit_stan_model(   data,   main_model_covariates,   imputation_model_covariates,   imputation_distribution = c(\"normal\", \"bernoulli\", \"beta_binomial\",     \"negative_binomial\"),   parameterization = c(\"noncentered\", \"centered\"),   n_chains = 4,   iter_warmup = 1000,   iter_sampling = 1000,   adapt_delta = 0.8,   seed = 777L,   parallel_chains = 1L )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_stan_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a Bayesian two-stage model using Stan — fit_stan_model","text":"data data frame containing outcome covariates main_model_covariates Character vector covariate names main model imputation_model_covariates Character vector covariate names imputation model imputation_distribution Distribution imputation model: \"normal\" continuous x, \"bernoulli\" binary x, \"beta_binomial\" bounded count data, \"negative_binomial\" unbounded count data (default: \"normal\") parameterization Parameterization random effects: \"noncentered\" (default) works better weakly informative data (small N), \"centered\" works better highly informative data (large N). Available imputation distributions. n_chains Number MCMC chains (default: 4) iter_warmup Number warmup iterations per chain (default: 1000) iter_sampling Number sampling iterations per chain (default: 1000) adapt_delta Target acceptance rate HMC (default: 0.8) seed Random seed reproducibility (default: 777L) parallel_chains Number chains run parallel (default: 1L)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_stan_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a Bayesian two-stage model using Stan — fit_stan_model","text":"CmdStanMCMC fit object","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/format_data_mcmc.html","id":null,"dir":"Reference","previous_headings":"","what":"Format the simulated data for Stan — format_data_mcmc","title":"Format the simulated data for Stan — format_data_mcmc","text":"Format simulated data Stan","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/format_data_mcmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format the simulated data for Stan — format_data_mcmc","text":"","code":"format_data_mcmc(   data,   main_model_covariates = NULL,   imputation_model_covariates = NULL,   imputation_distribution = c(\"normal\", \"bernoulli\", \"beta_binomial\",     \"negative_binomial\") )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/format_data_mcmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format the simulated data for Stan — format_data_mcmc","text":"data Dataset use main_model_covariates Character vector column names covariates main model imputation_model_covariates Character vector column names covariates imputation model imputation_distribution Distribution imputation model: \"normal\" continuous x, \"bernoulli\" binary x, \"beta_binomial\" bounded count data, \"negative_binomial\" unbounded count data","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/format_data_mcmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format the simulated data for Stan — format_data_mcmc","text":"list suitable input MCMC software","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate correlated random intercept / slope longitudinal data — generate_data","title":"Generate correlated random intercept / slope longitudinal data — generate_data","text":"Generates simulated longitudinal data correlated random intercepts slopes testing two-stage design methods.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate correlated random intercept / slope longitudinal data — generate_data","text":"","code":"generate_data(   N = 2000,   M = 5,   alpha_main = 1,   beta_x = 1,   beta_z = 1,   beta_t = 2,   beta_t_x_interaction = 0.3,   beta_t_z_interaction = 0,   error_sd = 4,   x_dist = c(\"normal\", \"poisson\", \"binomial\", \"negative_binomial\", \"beta_binomial\"),   x_size = NULL,   x_disp_param = NULL,   rand_intercept_sd = 3,   rand_slope_sd = 1,   rand_eff_corr = 0,   gamma0 = 1,   gamma1 = 1,   gamma2 = 0,   gamma_sd = 2 )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate correlated random intercept / slope longitudinal data — generate_data","text":"N Number subjects (default: 2000) M Number time points per subject (default: 5) alpha_main Intercept main model (default: 1) beta_x Coefficient x main model (default: 1) beta_z Coefficient z main model (default: 1) beta_t Coefficient time main model (default: 2) beta_t_x_interaction Coefficient time-x interaction (default: 0.3) beta_t_z_interaction Coefficient time-z interaction (default: 0) error_sd Standard deviation residual error (default: 4) x_dist Distribution x: \"normal\", \"poisson\", \"binomial\", \"negative_binomial\", \"beta_binomial\" (default: \"normal\") x_size Size parameter binomial/beta_binomial distributions x_disp_param Dispersion parameter negative_binomial/beta_binomial rand_intercept_sd Standard deviation random intercepts (default: 3) rand_slope_sd Standard deviation random slopes (default: 1) rand_eff_corr Correlation random intercepts slopes (default: 0) gamma0 Intercept imputation model (default: 1) gamma1 Linear coefficient z imputation model (default: 1) gamma2 Quadratic coefficient z imputation model (default: 0) gamma_sd Standard deviation imputation model (normal distribution ) (default: 2)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate correlated random intercept / slope longitudinal data — generate_data","text":"data frame simulated longitudinal data","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data_schild_2019_supp.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate correlated random intercept / slope longitudinal data to test two-stage design methods. In the form of Schildcrout (2019) supplement — generate_data_schild_2019_supp","title":"Generate correlated random intercept / slope longitudinal data to test two-stage design methods. In the form of Schildcrout (2019) supplement — generate_data_schild_2019_supp","text":"Generate correlated random intercept / slope longitudinal data test two-stage design methods. form Schildcrout (2019) supplement","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data_schild_2019_supp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate correlated random intercept / slope longitudinal data to test two-stage design methods. In the form of Schildcrout (2019) supplement — generate_data_schild_2019_supp","text":"","code":"generate_data_schild_2019_supp(   N,   Ms,   alpha_main,   beta_x,   beta_z,   beta_t,   beta_t_x_interaction,   beta_t_z_interaction,   error_sd,   x_prevalence,   rand_intercept_sd,   rand_slope_sd,   rand_eff_corr,   gamma0,   gamma1,   gamma2,   gamma_sd )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data_schild_2019_supp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate correlated random intercept / slope longitudinal data to test two-stage design methods. In the form of Schildcrout (2019) supplement — generate_data_schild_2019_supp","text":"N Integer. Total number subjects cohort. Default 2000. Ms Integer vector. Possible numbers observations per subject, sampled uniformly. Default c(4, 5, 6). alpha_main Numeric. Fixed intercept (beta_0). Default 75. beta_x Numeric. Main effect binary exposure X (beta_s). Default -0.5. beta_z Numeric. Effect continuous confounder Z (beta_c). Default -2. beta_t Numeric. Fixed time effect (beta_t). Default -1. beta_t_x_interaction Numeric. Interaction time exposure (beta_st). Default -0.5. beta_t_z_interaction Numeric. Interaction time confounder. Default 0. error_sd Numeric. Standard deviation measurement error (sigma_e). Default sqrt(12.25) = 3.5. x_prevalence Numeric. Prevalence binary exposure X. Must 0 1. Default 0.25. rand_intercept_sd Numeric. Standard deviation random intercept (sigma_0). Default sqrt(81) = 9. rand_slope_sd Numeric. Standard deviation random slope (sigma_1). Default sqrt(1.56) = 1.25. rand_eff_corr Numeric. Correlation random intercept slope (rho). Must -1 1. Default 0. gamma0 Numeric. Intercept confounder Z generation. Default 0.25. gamma1 Numeric. Linear coefficient X Z generation. Default 0.5. gamma2 Numeric. Quadratic coefficient X Z generation. Default 0. gamma_sd Numeric. Standard deviation Z residual error. Default 1.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data_schild_2019_supp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate correlated random intercept / slope longitudinal data to test two-stage design methods. In the form of Schildcrout (2019) supplement — generate_data_schild_2019_supp","text":"dataset","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/get_gamma_posterior_mean.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract posterior means for gamma — get_gamma_posterior_mean","title":"Extract posterior means for gamma — get_gamma_posterior_mean","text":"Extract posterior means gamma","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/get_gamma_posterior_mean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract posterior means for gamma — get_gamma_posterior_mean","text":"","code":"get_gamma_posterior_mean(summary_df)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/get_gamma_posterior_mean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract posterior means for gamma — get_gamma_posterior_mean","text":"summary_df Summary data frame fit$summary()","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/get_gamma_posterior_mean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract posterior means for gamma — get_gamma_posterior_mean","text":"Vector gamma posterior means","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/get_ppc_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract observed x and design matrix Z safely — get_ppc_data","title":"Extract observed x and design matrix Z safely — get_ppc_data","text":"Extract observed x design matrix Z safely","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/get_ppc_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract observed x and design matrix Z safely — get_ppc_data","text":"","code":"get_ppc_data(data, imputation_covariates)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/get_ppc_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract observed x and design matrix Z safely — get_ppc_data","text":"data Full data frame imputation_covariates Character vector covariate names","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/get_ppc_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract observed x and design matrix Z safely — get_ppc_data","text":"List x (vector) Z (matrix)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a subject-specific contribution to a log-likelihood for longitudinal normal data — li.lme","title":"Calculate a subject-specific contribution to a log-likelihood for longitudinal normal data — li.lme","text":"Calculate subject-specific contribution log-likelihood longitudinal normal data","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a subject-specific contribution to a log-likelihood for longitudinal normal data — li.lme","text":"","code":"li.lme(yi, xi, beta, vi)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a subject-specific contribution to a log-likelihood for longitudinal normal data — li.lme","text":"yi n_i-response vector xi n_i p design matrix fixed effects beta mean model parameter vector vi variance covariance matrix (ZDZ+Sige2*)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a subject-specific contribution to a log-likelihood for longitudinal normal data — li.lme","text":"subject specific contribution log-likelihood","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.score2.html","id":null,"dir":"Reference","previous_headings":"","what":"Subject specific contribution to the lme model score (also returns marginal Vi=Cov(Y|X)) — li.lme.score2","title":"Subject specific contribution to the lme model score (also returns marginal Vi=Cov(Y|X)) — li.lme.score2","text":"Subject specific contribution lme model score (also returns marginal Vi=Cov(Y|X))","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.score2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subject specific contribution to the lme model score (also returns marginal Vi=Cov(Y|X)) — li.lme.score2","text":"","code":"li.lme.score2(subjectData, beta, sigma.vc, rho.vc, sigma.e)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.score2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subject specific contribution to the lme model score (also returns marginal Vi=Cov(Y|X)) — li.lme.score2","text":"subjectData list contains yi, xi, zi, Weights..  Note Weights.used inverse probability weighting . beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.score2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subject specific contribution to the lme model score (also returns marginal Vi=Cov(Y|X)) — li.lme.score2","text":"Subject specific contribution log-likelihood score (also returns marginal Vi=Cov(Y|X))","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.html","id":null,"dir":"Reference","previous_headings":"","what":"Log of the Ascertainment correction for univariate sampling — logACi1q","title":"Log of the Ascertainment correction for univariate sampling — logACi1q","text":"Calculate log transformed ascertainment correction univariate Q_i.  Also return vi","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log of the Ascertainment correction for univariate sampling — logACi1q","text":"","code":"logACi1q(yi, xi, zi, wi, beta, sigma.vc, rho.vc, sigma.e, cutpoints, SampProb)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log of the Ascertainment correction for univariate sampling — logACi1q","text":"yi n_i-response vector xi n_i p design matrix fixed effects zi n_i q design matric random effects (intercept slope) wi pre-multiplier yi generate sampling variable q_i beta mean model parameter vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution cutpoints cutpoints defining sampling regions. (vector length 2) SampProb Sampling probabilities within region (vector length 3).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log of the Ascertainment correction for univariate sampling — logACi1q","text":"log transformed ascertainment correction","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.score2.html","id":null,"dir":"Reference","previous_headings":"","what":"Gradient of the log of the ascertainment correction piece for sampling based on univariate Q_i — logACi1q.score2","title":"Gradient of the log of the ascertainment correction piece for sampling based on univariate Q_i — logACi1q.score2","text":"Calculate gradient log transformed ascertainment correction sampling based univariate Q_i","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.score2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gradient of the log of the ascertainment correction piece for sampling based on univariate Q_i — logACi1q.score2","text":"","code":"logACi1q.score2(subjectData, beta, sigma.vc, rho.vc, sigma.e)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.score2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gradient of the log of the ascertainment correction piece for sampling based on univariate Q_i — logACi1q.score2","text":"subjectData list containing: yi, xi, zi, Weights., w.function., SampProb., cutpoints.beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.score2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gradient of the log of the ascertainment correction piece for sampling based on univariate Q_i — logACi1q.score2","text":"gradient log transformed ascertainment correction univariate $Q_i$","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.html","id":null,"dir":"Reference","previous_headings":"","what":"Log of the Ascertainment correction piece for bivariate sampling — logACi2q","title":"Log of the Ascertainment correction piece for bivariate sampling — logACi2q","text":"Calculate log transformed ascertainment correction bivariate Q_i.  Also return vi","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log of the Ascertainment correction piece for bivariate sampling — logACi2q","text":"","code":"logACi2q(yi, xi, zi, wi, beta, sigma.vc, rho.vc, sigma.e, cutpoints, SampProb)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log of the Ascertainment correction piece for bivariate sampling — logACi2q","text":"yi n_i-response vector xi n_i p design matrix fixed effects zi n_i q design matric random effects (intercept slope) wi pre-multiplier yi generate sampling variable q_i beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution cutpoints cutpoints defining sampling regions. (vector length 4 c(xlow, xhigh, ylow, yhigh)) SampProb Sampling probabilities within region (vector length 2 c(central region, outlying region)).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log of the Ascertainment correction piece for bivariate sampling — logACi2q","text":"log transformed ascertainment correction","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.score2.html","id":null,"dir":"Reference","previous_headings":"","what":"Gradient of the log of the ascertainment correction piece for sampling based on bivariate Q_i. — logACi2q.score2","title":"Gradient of the log of the ascertainment correction piece for sampling based on bivariate Q_i. — logACi2q.score2","text":"Calculate gradient log transformed ascertainment correction designs sample based bivariate Q_i (numerically).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.score2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gradient of the log of the ascertainment correction piece for sampling based on bivariate Q_i. — logACi2q.score2","text":"","code":"logACi2q.score2(subjectData, beta, sigma.vc, rho.vc, sigma.e)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.score2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gradient of the log of the ascertainment correction piece for sampling based on bivariate Q_i. — logACi2q.score2","text":"subjectData list containing: yi, xi, zi, Weights., w.function, SampProb, cutpoints beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.score2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gradient of the log of the ascertainment correction piece for sampling based on bivariate Q_i. — logACi2q.score2","text":"gradient log transformed ascertainment correction bivariate sampling design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_forest.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a forest plot of MCMC output — mcmc_forest","title":"Create a forest plot of MCMC output — mcmc_forest","text":"wrapper around MCMCvis::MCMCplot create forest plots MCMC samples.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_forest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a forest plot of MCMC output — mcmc_forest","text":"","code":"mcmc_forest(mcmc_output)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_forest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a forest plot of MCMC output — mcmc_forest","text":"mcmc_output MCMC output object","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_forest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a forest plot of MCMC output — mcmc_forest","text":"forest plot parameter estimates","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract MCMC summary statistics — mcmc_summary","title":"Extract MCMC summary statistics — mcmc_summary","text":"wrapper around MCMCvis::MCMCsummary extract summary statistics MCMC samples. CmdStanR fits, also extracts HMC diagnostics (divergent transitions, max treedepth exceeded, E-BFMI).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract MCMC summary statistics — mcmc_summary","text":"","code":"mcmc_summary(mcmc_output, dataset_id)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract MCMC summary statistics — mcmc_summary","text":"mcmc_output MCMC output object dataset_id character string identifying dataset (added column)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract MCMC summary statistics — mcmc_summary","text":"data frame summary statistics parameter","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_trace.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot MCMC trace plots — mcmc_trace","title":"Plot MCMC trace plots — mcmc_trace","text":"wrapper around MCMCvis::MCMCtrace create trace plots MCMC samples.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_trace.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot MCMC trace plots — mcmc_trace","text":"","code":"mcmc_trace(mcmc_output, print_to_pdf = FALSE)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_trace.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot MCMC trace plots — mcmc_trace","text":"mcmc_output MCMC output object print_to_pdf Logical; TRUE, saves trace plots PDF file","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_trace.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot MCMC trace plots — mcmc_trace","text":"Trace plots MCMC samples","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ods_design.html","id":null,"dir":"Reference","previous_headings":"","what":"Set x to missing based on an ODS design — ods_design","title":"Set x to missing based on an ODS design — ods_design","text":"Set x missing based ODS design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ods_design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set x to missing based on an ODS design — ods_design","text":"","code":"ods_design(   data,   sampling_type,   cutoff_high,   cutoff_low,   n_sampled,   prop_high,   prop_middle,   prop_low )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ods_design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set x to missing based on an ODS design — ods_design","text":"data Dataset use sampling_type type sampling? \"intercept\" \"slope\" cutoff_high quantile use cutoff High category cutoff_low quantile use cutoff Low category n_sampled many subjects sampled? prop_high proportion sample High category? prop_middle proportion sample Middle category? prop_low proportion sample Low category?","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ods_design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set x to missing based on an ODS design — ods_design","text":"dataset x values selected based ODS design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/plot_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot simulated data — plot_data","title":"Plot simulated data — plot_data","text":"Plot simulated data","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/plot_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot simulated data — plot_data","text":"","code":"plot_data(data, subset_size = 200)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/plot_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot simulated data — plot_data","text":"data Dataset use subset_size many subjects use?","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/plot_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot simulated data — plot_data","text":"ggplot2 object","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior Predictive Checks for Imputation Model — ppc_imputation","title":"Posterior Predictive Checks for Imputation Model — ppc_imputation","text":"Functions diagnose imputation model adequacy","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior Predictive Checks for Imputation Model — ppc_imputation","text":"","code":"ppc_imputation(   fit,   data,   imputation_covariates,   distribution = c(\"normal\", \"bernoulli\", \"negative_binomial\", \"beta_binomial\"),   n_draws = 1000 )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior Predictive Checks for Imputation Model — ppc_imputation","text":"fit CmdStanMCMC fit object fit_stan_model() data Data frame used fitting imputation_covariates Character vector imputation model covariate names distribution Imputation distribution used n_draws Number posterior draws simulations","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior Predictive Checks for Imputation Model — ppc_imputation","text":"List diagnostic results plots","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_bernoulli.html","id":null,"dir":"Reference","previous_headings":"","what":"PPC for Bernoulli imputation model — ppc_imputation_bernoulli","title":"PPC for Bernoulli imputation model — ppc_imputation_bernoulli","text":"PPC Bernoulli imputation model","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_bernoulli.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PPC for Bernoulli imputation model — ppc_imputation_bernoulli","text":"","code":"ppc_imputation_bernoulli(fit, data, imputation_covariates, n_draws = 1000)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_bernoulli.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PPC for Bernoulli imputation model — ppc_imputation_bernoulli","text":"fit CmdStanMCMC fit object data Data frame imputation_covariates Character vector imputation model covariates n_draws Number posterior draws","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_bernoulli.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PPC for Bernoulli imputation model — ppc_imputation_bernoulli","text":"List calibration plot, ROC metrics","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_beta_binomial.html","id":null,"dir":"Reference","previous_headings":"","what":"PPC for beta-binomial imputation model — ppc_imputation_beta_binomial","title":"PPC for beta-binomial imputation model — ppc_imputation_beta_binomial","text":"PPC beta-binomial imputation model","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_beta_binomial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PPC for beta-binomial imputation model — ppc_imputation_beta_binomial","text":"","code":"ppc_imputation_beta_binomial(fit, data, imputation_covariates, n_draws = 500)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_beta_binomial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PPC for beta-binomial imputation model — ppc_imputation_beta_binomial","text":"fit CmdStanMCMC fit object data Data frame imputation_covariates Character vector imputation model covariates n_draws Number posterior draws","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_beta_binomial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PPC for beta-binomial imputation model — ppc_imputation_beta_binomial","text":"List diagnostics","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_count.html","id":null,"dir":"Reference","previous_headings":"","what":"PPC for count imputation model (negative binomial) — ppc_imputation_count","title":"PPC for count imputation model (negative binomial) — ppc_imputation_count","text":"PPC count imputation model (negative binomial)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_count.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PPC for count imputation model (negative binomial) — ppc_imputation_count","text":"","code":"ppc_imputation_count(fit, data, imputation_covariates, n_draws = 500)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_count.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PPC for count imputation model (negative binomial) — ppc_imputation_count","text":"fit CmdStanMCMC fit object data Data frame imputation_covariates Character vector imputation model covariates n_draws Number posterior draws","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_count.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PPC for count imputation model (negative binomial) — ppc_imputation_count","text":"List rootogram dispersion check","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior predictive density check for imputation model — ppc_imputation_density","title":"Posterior predictive density check for imputation model — ppc_imputation_density","text":"Posterior predictive density check imputation model","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior predictive density check for imputation model — ppc_imputation_density","text":"","code":"ppc_imputation_density(fit, data, imputation_covariates, n_draws = 100)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior predictive density check for imputation model — ppc_imputation_density","text":"fit CmdStanMCMC fit object fit_stan_model() data Data frame used fitting imputation_covariates Character vector imputation model covariates n_draws Number posterior draws visualize","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_density.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior predictive density check for imputation model — ppc_imputation_density","text":"ggplot object","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_intervals.html","id":null,"dir":"Reference","previous_headings":"","what":"Check prediction interval coverage — ppc_imputation_intervals","title":"Check prediction interval coverage — ppc_imputation_intervals","text":"Check prediction interval coverage","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_intervals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check prediction interval coverage — ppc_imputation_intervals","text":"","code":"ppc_imputation_intervals(   fit,   data,   imputation_covariates,   prob = 0.95,   n_draws = 1000 )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_intervals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check prediction interval coverage — ppc_imputation_intervals","text":"fit CmdStanMCMC fit object data Data frame imputation_covariates Character vector imputation model covariates prob Coverage probability n_draws Number posterior draws","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_intervals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check prediction interval coverage — ppc_imputation_intervals","text":"List coverage proportion plot","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_residuals.html","id":null,"dir":"Reference","previous_headings":"","what":"Residual diagnostics for normal imputation model — ppc_imputation_residuals","title":"Residual diagnostics for normal imputation model — ppc_imputation_residuals","text":"Residual diagnostics normal imputation model","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_residuals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Residual diagnostics for normal imputation model — ppc_imputation_residuals","text":"","code":"ppc_imputation_residuals(fit, data, imputation_covariates)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_residuals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Residual diagnostics for normal imputation model — ppc_imputation_residuals","text":"fit CmdStanMCMC fit object data Data frame imputation_covariates Character vector imputation model covariates","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_residuals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Residual diagnostics for normal imputation model — ppc_imputation_residuals","text":"List diagnostic plots","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_stat.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior predictive check for a summary statistic — ppc_imputation_stat","title":"Posterior predictive check for a summary statistic — ppc_imputation_stat","text":"Posterior predictive check summary statistic","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_stat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior predictive check for a summary statistic — ppc_imputation_stat","text":"","code":"ppc_imputation_stat(   fit,   data,   imputation_covariates,   stat = mean,   stat_name = \"Mean\",   n_draws = 1000 )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_stat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior predictive check for a summary statistic — ppc_imputation_stat","text":"fit CmdStanMCMC fit object data Data frame used fitting imputation_covariates Character vector imputation model covariates stat Function compute statistic stat_name Name display n_draws Number posterior draws","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ppc_imputation_stat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior predictive check for a summary statistic — ppc_imputation_stat","text":"List observed value, predicted distribution, p-value, plot","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/print.ppc_imputation.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for ppc_imputation results — print.ppc_imputation","title":"Print method for ppc_imputation results — print.ppc_imputation","text":"Print method ppc_imputation results","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/print.ppc_imputation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for ppc_imputation results — print.ppc_imputation","text":"","code":"# S3 method for class 'ppc_imputation' print(x, ...)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/print.ppc_imputation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for ppc_imputation results — print.ppc_imputation","text":"x ppc_imputation results ... Additional arguments (unused)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/set_missing.html","id":null,"dir":"Reference","previous_headings":"","what":"Given selected subjects, set X to missing for those not selected — set_missing","title":"Given selected subjects, set X to missing for those not selected — set_missing","text":"Given selected subjects, set X missing selected","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/set_missing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Given selected subjects, set X to missing for those not selected — set_missing","text":"","code":"set_missing(data, selected_ids)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/set_missing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Given selected subjects, set X to missing for those not selected — set_missing","text":"data Input data frame selected_ids IDs selected subjects","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/set_missing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Given selected subjects, set X to missing for those not selected — set_missing","text":"data.frame","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/srs_design.html","id":null,"dir":"Reference","previous_headings":"","what":"Set x to missing based on an SRS design — srs_design","title":"Set x to missing based on an SRS design — srs_design","text":"Set x missing based SRS design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/srs_design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set x to missing based on an SRS design — srs_design","text":"","code":"srs_design(data, n_sampled)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/srs_design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set x to missing based on an SRS design — srs_design","text":"data Dataset use n_sampled many subjects sample?","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/srs_design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set x to missing based on an SRS design — srs_design","text":"dataset x values selected based SRS design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/vi.calc.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate V_i = Z_i D t(Z_i) + sig_e^2 I_(n_i) — vi.calc","title":"Calculate V_i = Z_i D t(Z_i) + sig_e^2 I_(n_i) — vi.calc","text":"Calculate V_i = Z_i D t(Z_i) + sig_e^2 I_(n_i)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/vi.calc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate V_i = Z_i D t(Z_i) + sig_e^2 I_(n_i) — vi.calc","text":"","code":"vi.calc(zi, sigma.vc, rho.vc, sigma.e)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/vi.calc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate V_i = Z_i D t(Z_i) + sig_e^2 I_(n_i) — vi.calc","text":"zi n_i q design matrix random effects sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/vi.calc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate V_i = Z_i D t(Z_i) + sig_e^2 I_(n_i) — vi.calc","text":"V_i","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/news/index.html","id":"bayes2stage-0009000","dir":"Changelog","previous_headings":"","what":"bayes2stage 0.0.0.9000","title":"bayes2stage 0.0.0.9000","text":"Stan-based model fitting via fit_stan_model() using ‘instantiate’ package. Support four covariate distributions: normal, bernoulli, negative binomial, beta binomial. Three sampling design functions: srs_design(), ods_design(), bds_design(). Ascertainment-corrected maximum likelihood estimation via fit_acml_ods(). Data simulation generate_data() supporting multiple covariate distributions. Added package vignette complete workflow example. Archived NIMBLE-based fitting code (available archived/ directory).","code":""}]
