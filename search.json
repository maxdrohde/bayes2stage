[{"path":"https://maxdrohde.github.io/bayes2stage/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 bayes2stage authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with bayes2stage","text":"Two-stage designs cost-effective approach studies key covariate expensive measure. first stage, inexpensive outcome data collected subjects. second stage, expensive covariate measured strategically selected subset. bayes2stage package provides tools : Simulating longitudinal data random effects Designing second-stage sample using outcome-dependent BLUP-dependent sampling Fitting Bayesian mixed effects models impute missing covariate values","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"example-workflow","dir":"Articles","previous_headings":"","what":"Example Workflow","title":"Getting Started with bayes2stage","text":"First, simulate longitudinal data subject repeated measurements time: data includes: y: outcome measured time point t: time (scaled 0-1) x: expensive covariate (constant within subject) z: cheap covariate (constant within subject) id: subject identifier Now select subjects x measured. Outcome-dependent sampling (ODS) selects subjects based estimated trajectories, oversampling tails: subjects selected, x set NA. Stan-based model jointly estimates outcome model imputes missing x values:","code":"library(bayes2stage)  set.seed(123) data <- generate_data(   N = 1000,                    # 1000 subjects  M = 5,                       # 5 time points each   x_dist = \"normal\",           # x is continuous   beta_x = 1,                  # effect of x on outcome   beta_t = 2,                  # effect of time   beta_t_x_interaction = 0.3,  # x modifies the trajectory   rand_intercept_sd = 3,       # subject-level intercept variation   rand_slope_sd = 1            # subject-level slope variation )  head(data) stage2_data <- ods_design(   data,   sampling_type = \"slope\",     # select based on OLS slopes   cutoff_low = 0.25,           # bottom 25% = \"low\" stratum   cutoff_high = 0.75,          # top 25% = \"high\" stratum   n_sampled = 200,             # sample 200 subjects total   prop_low = 0.4,              # 40% from low stratum   prop_middle = 0.2,           # 20% from middle   prop_high = 0.4              # 40% from high stratum )  # Check how many have x observed vs missing table(is.na(stage2_data$x)) fit <- fit_stan_model(   data = stage2_data,   main_model_covariates = c(\"x\", \"z\", \"t\"),   imputation_model_covariates = c(\"z\"),   imputation_distribution = \"normal\",   n_chains = 4,   iter_warmup = 1000,   iter_sampling = 1000,   parallel_chains = 4 ) # Parameter summaries fit$summary(variables = c(\"alpha\", \"beta_x\", \"beta_z\", \"beta_t\"))  # Trace plots for diagnostics mcmc_trace(fit)"},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"step-1-generate-data","dir":"Articles","previous_headings":"","what":"Step 1: Generate Data","title":"Getting Started with bayes2stage","text":"First, simulate longitudinal data subject repeated measurements time: data includes: y: outcome measured time point t: time (scaled 0-1) x: expensive covariate (constant within subject) z: cheap covariate (constant within subject) id: subject identifier","code":"library(bayes2stage)  set.seed(123) data <- generate_data(   N = 1000,                    # 1000 subjects  M = 5,                       # 5 time points each   x_dist = \"normal\",           # x is continuous   beta_x = 1,                  # effect of x on outcome   beta_t = 2,                  # effect of time   beta_t_x_interaction = 0.3,  # x modifies the trajectory   rand_intercept_sd = 3,       # subject-level intercept variation   rand_slope_sd = 1            # subject-level slope variation )  head(data)"},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"step-2-apply-a-sampling-design","dir":"Articles","previous_headings":"","what":"Step 2: Apply a Sampling Design","title":"Getting Started with bayes2stage","text":"Now select subjects x measured. Outcome-dependent sampling (ODS) selects subjects based estimated trajectories, oversampling tails: subjects selected, x set NA.","code":"stage2_data <- ods_design(   data,   sampling_type = \"slope\",     # select based on OLS slopes   cutoff_low = 0.25,           # bottom 25% = \"low\" stratum   cutoff_high = 0.75,          # top 25% = \"high\" stratum   n_sampled = 200,             # sample 200 subjects total   prop_low = 0.4,              # 40% from low stratum   prop_middle = 0.2,           # 20% from middle   prop_high = 0.4              # 40% from high stratum )  # Check how many have x observed vs missing table(is.na(stage2_data$x))"},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"step-3-fit-a-bayesian-model","dir":"Articles","previous_headings":"","what":"Step 3: Fit a Bayesian Model","title":"Getting Started with bayes2stage","text":"Stan-based model jointly estimates outcome model imputes missing x values:","code":"fit <- fit_stan_model(   data = stage2_data,   main_model_covariates = c(\"x\", \"z\", \"t\"),   imputation_model_covariates = c(\"z\"),   imputation_distribution = \"normal\",   n_chains = 4,   iter_warmup = 1000,   iter_sampling = 1000,   parallel_chains = 4 )"},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"step-4-examine-results","dir":"Articles","previous_headings":"","what":"Step 4: Examine Results","title":"Getting Started with bayes2stage","text":"","code":"# Parameter summaries fit$summary(variables = c(\"alpha\", \"beta_x\", \"beta_z\", \"beta_t\"))  # Trace plots for diagnostics mcmc_trace(fit)"},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"sampling-design-options","dir":"Articles","previous_headings":"","what":"Sampling Design Options","title":"Getting Started with bayes2stage","text":"package provides three sampling strategies:","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"supported-covariate-distributions","dir":"Articles","previous_headings":"","what":"Supported Covariate Distributions","title":"Getting Started with bayes2stage","text":"Choose imputation distribution based nature x:","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"alternative-acml-estimation","dir":"Articles","previous_headings":"","what":"Alternative: ACML Estimation","title":"Getting Started with bayes2stage","text":"frequentist analysis, use ascertainment-corrected maximum likelihood:","code":"acml_fit <- fit_acml_ods(   ods_df = stage2_data,   cutoff_low = 0.25,   cutoff_high = 0.75 )  acml_fit"},{"path":"https://maxdrohde.github.io/bayes2stage/articles/bayes2stage.html","id":"further-reading","dir":"Articles","previous_headings":"","what":"Further Reading","title":"Getting Started with bayes2stage","text":"Package documentation: ?fit_stan_model, ?ods_design, ?generate_data GitHub: https://github.com/maxdrohde/bayes2stage","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Maximilian Rohde. Author, maintainer.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Rohde M (2025). bayes2stage: Bayesian Analysis Two-Stage Designs Longitudinal Data. R package version 0.0.0.9000, https://github.com/maxdrohde/bayes2stage.","code":"@Manual{,   title = {bayes2stage: Bayesian Analysis of Two-Stage Designs with Longitudinal Data},   author = {Maximilian Rohde},   year = {2025},   note = {R package version 0.0.0.9000},   url = {https://github.com/maxdrohde/bayes2stage}, }"},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt.html","id":"id_1-aim-and-positioning","dir":"","previous_headings":"","what":"1. Aim and Positioning","title":"Paper Outline: Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Goal: demonstrate efficient inference expensive, subject-level covariate measured subsample, leveraging longitudinal outcomes Bayesian joint modeling. Audience: methodological statisticians applied researchers designing biomarker/genomics/clinical monitoring studies. Deliverables: evidence outcome/BLUP-dependent designs + joint Bayesian imputation improve efficiency vs SRS frequentist ACML.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt.html","id":"id_2-introduction--motivation","dir":"","previous_headings":"","what":"2. Introduction & Motivation","title":"Paper Outline: Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Problem: high-cost covariates; abundant repeated outcomes; need maximize information cost constraints. Two-stage designs: collect y,z everyone; measure x selected subjects; oversample trajectory tails (ODS/BDS) gain power x effects. Gaps: limited Bayesian tools () handle multiple x distributions, (b) fully marginalize discrete x, (c) integrate design selection, (d) provide open-source implementations. Unified Stan models normal, Bernoulli, negative binomial, beta-binomial x random intercept/slope outcome model x imputation. Optimizations (pos/len indices, marginalized discrete x, vectorized likelihoods) computational efficiency. Design functions: srs_design(), ods_design() (OLS intercept/slope strata), bds_design() (BLUP strata). Frequentist comparator: ascertainment-corrected ML (fit_acml_ods()). Open-source R package + vignette full workflow.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt.html","id":"id_3-methods","dir":"","previous_headings":"","what":"3. Methods","title":"Paper Outline: Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Data structure & outcome model: subjects =1..N, times j=1..M; y model fixed effects (x, z, t, x*t), random intercept/slope correlation; t scaled 0‚Äì1; z observed ; x partially observed. SRS baseline. ODS: strata OLS intercept/slope; cutoff_low/high stratum proportions. BDS: strata BLUP intercept/slope mixed model; sensitivity M RE variance. Outcome: non-centered random effects, correlated intercept/slope; priors exponential scales, weakly-informative normals fixed effects. Imputation families: normal (continuous x), Bernoulli (logit), negative binomial (log-mean dispersion), beta-binomial (logit-mean concentration). Missing x handling: latent draws continuous; marginalized discrete x via log_sum_exp; shared inference outcome imputation parameters. Computation: Stan via instantiate; vectorized main-model likelihood; precomputed id indices; diagnostics (R-hat, ESS, divergences, E-BFMI). Frequentist comparator (ACML): ODS-correction using sampling probabilities; robust SEs; scope assumptions.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt.html","id":"id_4-simulation-study-plan","dir":"","previous_headings":"","what":"4. Simulation Study Plan","title":"Paper Outline: Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Objectives: assess bias/RMSE, 95% coverage, interval width, power (x) ({tx}), imputation accuracy x, cost-adjusted efficiency, computational performance. N: 500, 1000, 2000; time points M: 3‚Äì8; random-effect SDs (small/medium/large) correlations (0, 0.3, 0.6); residual SD. Effects: (x) ({tx}) 0 (type ), moderate, strong; include null error control. Covariate types: normal; Bernoulli (p=0.2, 0.5); neg-bin (vary mean/dispersion); beta-binomial (vary n_trials, concentration). Auxiliary strength: vary gamma coefficients linking z x (weak/medium/strong). Sampling fractions: 5‚Äì40% subjects; cutoff_low/high (e.g., 0.2/0.8); stratum proportions (symmetric vs tail-heavy). Designs: SRS, ODS-intercept, ODS-slope, BDS-intercept, BDS-slope. Misspecification: design slope interaction absent/present; imputation family misspecified (e.g., fit normal count x). Bayesian joint model (correct vs misspecified imputation family). ACML (ODS ). Naive complete-case (ignores design) full-data oracle benchmark. Bias, RMSE, interval width, coverage; power/type error; relative efficiency vs oracle. Imputation quality: MAE x, coverage x posteriors, calibration plots. Cost-adjusted efficiency: precision per unit cost (assign cost multiplier stage-2 x measurement). Computation: wall-clock, divergences, ESS/sec. Replication: ‚â•500 replicates per cell; Cantor seeds reproducibility; summarize via means/quantiles uncertainty bands.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt.html","id":"id_5-results-presentation","dir":"","previous_headings":"","what":"5. Results Presentation","title":"Paper Outline: Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Design visuals: histograms/density OLS/BLUP intercepts/slopes cutoff lines; selection heatmaps time. Tables bias/coverage/efficiency design x distribution. Power relative-efficiency curves vs sampling fraction effect size. Forest/ridge plots (x) ({tx}) posteriors across designs; overlay ACML point/intervals. Imputation diagnostics: observed vs imputed x distributions; calibration discrete x; scatter true vs posterior mean x missing cases. Cost vs precision plots; computational diagnostics (divergence rates, ESS/sec). Case study: stratum construction plot, fitted trajectories, forest plot key effects, posterior predictive checks y x.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt.html","id":"id_6-real-data-illustration-if-available","dir":"","previous_headings":"","what":"6. Real-Data Illustration (if available)","title":"Paper Outline: Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Context variables; stage-2 design setup (cutoffs, achieved sampling proportions). Fit Bayesian model matching x type; ACML ODS applicable. Report effects, uncertainty, practical interpretation; posterior predictive checks y x.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt.html","id":"id_7-discussion","dir":"","previous_headings":"","what":"7. Discussion","title":"Paper Outline: Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Key findings: ODS/BDS outperform SRS; value auxiliary z; robustness imputation misspecification. Guidance: choosing cutoffs/strata, recommended sampling fractions vs RE variance/M, minimum M stable BLUPs. Limitations: MAR given design variables; linear trajectories; baseline-x; x measurement error; computational demands larger N. Future work: time-varying expensive covariates; nonlinear trajectories; informative dropout; adaptive designs; alternative priors.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt.html","id":"id_8-reproducibility","dir":"","previous_headings":"","what":"8. Reproducibility","title":"Paper Outline: Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Package: bayes2stage (Stan code src/stan/), functions design/fitting (fit_stan_model(), fit_acml_ods()). Provide simulation scripts, seeds, session info, repository; suggest container/renv exact replication.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt.html","id":"id_9-appendices","dir":"","previous_headings":"","what":"9. Appendices","title":"Paper Outline: Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Full Stan model listings priors; ACML derivation; additional simulation tables/diagnostics; sensitivity analyses (adapt_delta, chains, priors).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":null,"dir":"","previous_headings":"","what":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Draft development; replace placeholder items (data source, numbers) study specifics.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"abstract","dir":"","previous_headings":"","what":"Abstract","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Two-stage designs attractive key covariate (e.g., biomarker omics assay) costly longitudinal outcomes widely available. propose Bayesian joint modeling framework combines mixed-effects outcome models covariate imputation, enabling efficient inference costly covariate measured subsample selected outcome- BLUP-dependent rules. bayes2stage package implements unified Stan models continuous, binary, count covariates (negative binomial, beta-binomial), optimized computational efficiency. compare outcome-dependent sampling (ODS), BLUP-dependent sampling (BDS), simple random sampling (SRS) across broad set simulation scenarios, benchmark ascertainment-corrected maximum likelihood (ACML) estimator. Results show tail-focused ODS/BDS strategies yield substantial precision gains covariate effects modest costs, well-calibrated uncertainty correct imputation families. illustrate approach case study provide open-source code full reproducibility. Keywords: two-stage design; outcome-dependent sampling; BLUP-dependent sampling; missing covariates; mixed-effects models; Bayesian imputation; Stan; ascertainment correction.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_1-introduction","dir":"","previous_headings":"","what":"1. Introduction","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Measuring expensive biomarkers genetic assays every participant often infeasible. longitudinal studies, repeated outcomes inexpensive covariates typically observed subjects. Two-stage designs exploit structure: stage 1 collects inexpensive measures everyone; stage 2 selects subsample costly covariate, often oversampling subjects extreme trajectories maximize information. Existing approaches either ignore stage-2 sampling downstream inference (leading bias inefficiency) rely frequentist ascertainment corrections specialized particular designs. Bayesian methods can jointly model outcome missing covariate, propagate uncertainty, flexibly handle diverse covariate types, practical, optimized implementations scarce. develop unified Bayesian framework two-stage longitudinal studies provide open-source implementation bayes2stage. framework supports SRS, ODS (intercept/slope strata OLS fits), BDS (intercept/slope strata mixed-model BLUPs). handles continuous, binary, bounded/unbounded count covariates optimized Stan code marginalizes discrete covariates possible. benchmark ascertainment-corrected maximum likelihood (ACML) estimator provide design guidance simulations case study.","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_21-data-structure-and-outcome-model","dir":"","previous_headings":"2. Methods","what":"2.1 Data structure and outcome model","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Subjects (=1,,N) observed times (j=1,,M_i) (often common M). outcome model [ y_{ij} = + x x_i + z z_i + (t + b{1i}) t{ij} + {tx} x_i t_{ij} + b_{0i} + {ij}, ] correlated random intercept/slope ((b{0i}, b_{1i}) (0, ) ) residuals ({ij} (0, {}^2)). Time scaled 0‚Äì1. Covariate z inexpensive observed subjects; x expensive, measured stage-2 sample.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_22-stage-2-sampling-strategies","dir":"","previous_headings":"2. Methods","what":"2.2 Stage-2 sampling strategies","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"SRS: random subsample subjects via srs_design(). ODS: define strata OLS intercepts slopes (ods_design()), using quantiles (cutoff_low/high) prespecified stratum proportions; oversample tails emphasize informative trajectories. BDS: define strata BLUP intercepts slopes mixed-effects model (bds_design()); requires sufficient time points stable BLUPs sensitive random-effect variance magnitude.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_23-bayesian-joint-model-with-imputation","dir":"","previous_headings":"2. Methods","what":"2.3 Bayesian joint model with imputation","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"jointly model y x. Implementation uses optimized Stan code src/stan/. Outcome component: non-centered random effects Cholesky factor (L_{re}) SDs (_{re}); fixed effects (_x, z, t, {tx}); Gaussian residual variance ({}^2). Likelihood vectorized; subject indices (id, pos, len) broadcast random effects efficiently. Normal: linear regression SD (_{}). Bernoulli: logit link. Negative binomial: log mean dispersion (). Beta-binomial: logit mean concentration () known trials (n_{}). Missing x handling: continuous x uses latent draws; discrete x marginalized log_sum_exp avoid discrete parameters improve mixing. Priors: exponential scale parameters (rate 0.1), weakly informative normals fixed effects (mean 0, sd 100 main effects; sd 2.5 imputation logits), LKJ prior correlation via lkj_corr_cholesky. choices balance weak informativeness computational stability. Diagnostics: R-hat, ESS, divergences, E-BFMI; graphical PPCs y x; calibration imputed x.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_24-frequentist-comparator-acml","dir":"","previous_headings":"2. Methods","what":"2.4 Frequentist comparator (ACML)","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"ODS designs, fit_acml_ods() implements ascertainment-corrected ML. Known sampling probabilities stratum correct likelihood; robust standard errors provide inference. serves comparator Bayesian approach ODS (intercept/slope) designs.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_25-computational-considerations","dir":"","previous_headings":"2. Methods","what":"2.5 Computational considerations","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Stan models leverage precomputed subject indices (pos, len) vectorization reduce gradient evaluations. Discrete x models integrate x avoid discrete parameters. Parallel chains via parallel_chains; adapt_delta tuned reduce divergences. Seeds via Cantor pairing reproducibility across simulation cells.","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_31-objectives","dir":"","previous_headings":"3. Simulation Study","what":"3.1 Objectives","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Assess: 1) Bias/RMSE 95% coverage (x) ({tx}); 2) Interval width power/type error; 3) Imputation quality x (MAE, calibration); 4) Cost-adjusted precision; 5) Computational performance (runtime, ESS/sec, divergences).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_32-data-generating-mechanisms","dir":"","previous_headings":"3. Simulation Study","what":"3.2 Data-generating mechanisms","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Use generate_data() generate_data_schild_2019_supp variants: - Sample sizes: N ‚àà {500, 1000, 2000}; time points M ‚àà {3, 5, 8}. - Random effects: SDs {1, 2, 4}; correlations {0, 0.3, 0.6}; residual SD {1, 2, 4} (scale scenario). - Effects: (x) ‚àà {0, 0.3, 0.6, 1.0}; ({tx}) ‚àà {0, 0.2, 0.4}. - Covariate types: normal; Bernoulli (p=0.2, 0.5); negative binomial (vary mean/dispersion); beta-binomial (vary trials/concentration). - Auxiliary strength: gamma coefficients linking z‚Üíx weak/medium/strong (e.g., gamma1 ‚àà {0.2, 0.6, 1.0}).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_33-design-factors","dir":"","previous_headings":"3. Simulation Study","what":"3.3 Design factors","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Sampling fractions: 5%, 10%, 20%, 40% subjects measured x. Strata cutoffs: (0.2, 0.8) (0.25, 0.75); stratum proportions symmetric vs tail-heavy (e.g., 0.4/0.2/0.4 low/mid/high). Designs: SRS, ODS-intercept, ODS-slope, BDS-intercept, BDS-slope. Misspecification: design slope (_{tx}=0); fit wrong imputation family (e.g., normal count x) test robustness.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_34-estimators","dir":"","previous_headings":"3. Simulation Study","what":"3.4 Estimators","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Bayesian joint model (correctly specified) x family. Bayesian joint model imputation misspecification (robustness stress). ACML ODS. Naive complete-case ignoring design. Oracle (full x observed) efficiency benchmark.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_35-metrics-and-analysis-plan","dir":"","previous_headings":"3. Simulation Study","what":"3.5 Metrics and analysis plan","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Compute bias, RMSE, interval width, coverage (x, {tx}) per cell; summarize across replicates (‚â•500 per cell) means quantiles. Power/type error rejection (H_0: _x=0). Relative efficiency: variance ratio vs oracle vs SRS. Imputation: MAE x among missing subjects; calibration x posteriors (coverage latent draws discrete x). Cost-adjusted precision: precision per cost unit stage-2 cost multiplier (e.g., 10√ó stage-1). Computational: wall-clock, ESS/sec, divergences; flag problematic settings.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_36-expected-qualitative-patterns-to-verify","dir":"","previous_headings":"3. Simulation Study","what":"3.6 Expected qualitative patterns (to verify)","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Tail-focused ODS/BDS reduce RMSE interval width (_x), especially effects moderate/large sampling 10‚Äì30% subjects. BDS may outperform ODS BLUPs stable (larger M, larger RE variance); ODS robust small M. Misspecified imputation degrades coverage discrete x; normal fit counts inflates bias dispersion large. Power gains taper beyond ~20‚Äì30% sampling; cost-adjusted efficiency plateaus.","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_41-main-simulation-tables","dir":"","previous_headings":"4. Results (populate with outputs)","what":"4.1 Main simulation tables","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Bias/RMSE/coverage (x, {tx}) design x type. Relative efficiency vs SRS oracle; power/type error summaries.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_42-figures","dir":"","previous_headings":"4. Results (populate with outputs)","what":"4.2 Figures","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Efficiency vs sampling fraction curves (per design, per x type). Forest/ridge plots (x, {tx}) posteriors across designs; overlay ACML point/CI. Imputation diagnostics: observed vs imputed x distributions; calibration plots discrete x; scatter true vs posterior mean x among missing cases. Cost vs precision trade-offs; computational diagnostics (ESS/sec, divergences). Design visuals: density OLS/BLUP intercepts/slopes cutoff lines; selection heatmaps time.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_43-sensitivity-analyses","dir":"","previous_headings":"4. Results (populate with outputs)","what":"4.3 Sensitivity analyses","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Vary adapt_delta/step size assess robustness HMC diagnostics. Alternative priors (tighter/looser scales) stability shrinkage effects. Impact weaker z‚Äìx association imputation performance.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_5-case-study-insert-application","dir":"","previous_headings":"","what":"5. Case Study (insert application)","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Setting: describe population, outcome, expensive covariate, auxiliary z. Design: construct ODS/BDS strata (intercept slope), report cutoffs achieved sampling fractions; compare hypothetical SRS. Models: fit Bayesian joint model matching x type; fit ACML ODS applicable. Outputs: effect estimates intervals; posterior predictive checks y x; selection visualizations; forest plot key effects; trajectory plots sampled vs unsampled subjects. Interpretation: practical implications estimated (x, {tx}); cost implications sampling strategy.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_6-discussion","dir":"","previous_headings":"","what":"6. Discussion","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Key findings: tail-focused two-stage designs joint Bayesian imputation improve efficiency costly covariate effects; gains largest effects trajectory heterogeneity moderate/large auxiliary z informative. Design guidance: pick cutoffs target informative tails; ensure enough time points BLUP stability using BDS; sample 10‚Äì30% costs high; align design estimand (use slope-based strata interaction primary target). Robustness: correct imputation family matters discrete x; auxiliary z improves calibration; BDS sensitive M RE variance; ODS simpler stable M small. Limitations: assumes MAR given design variables; linear trajectories; baseline (time-invariant) x; measurement error x; computation grows N despite vectorization. Future work: time-varying expensive covariates; nonlinear trajectories; informative dropout; adaptive response-adaptive designs; alternative priors variational approximations scalability.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_7-software-and-reproducibility","dir":"","previous_headings":"","what":"7. Software and Reproducibility","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Package: bayes2stage; Stan code src/stan/; design functions (srs_design(), ods_design(), bds_design()); Bayesian fitting via fit_stan_model(); ACML via fit_acml_ods(). Reproducibility: publish simulation scripts, seeds, session info; recommend renv containers; vignette (vignettes/bayes2stage.qmd) shows workflow.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_8-acknowledgments","dir":"","previous_headings":"","what":"8. Acknowledgments","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[Insert funding, collaborators, data acknowledgments.]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/chatgpt_full.html","id":"id_9-references","dir":"","previous_headings":"","what":"9. References","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[Insert citations two-stage designs, ODS/BDS literature, ACML, Bayesian missing data, Stan references, applied domain.]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"bayes2stage","dir":"","previous_headings":"","what":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"Warning: package still developed. use current state. bayes2stage provides tools designing analyzing two-stage studies longitudinal data. designs, expensive covariate measured strategically selected subset subjects, Bayesian imputation recovers information subjects missing covariate data.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"Two-stage designs useful : key covariate expensive invasive measure (e.g., biomarkers, genetic tests) Longitudinal outcome data available subjects want maximize statistical efficiency minimizing measurement costs package supports three sampling strategies selecting subjects measure: ODS BDS designs oversample tails trajectory distribution, improving efficiency detecting covariate effects.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"","code":"# install.packages(\"devtools\") devtools::install_github(\"maxdrohde/bayes2stage\")"},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"id_1-generate-or-load-longitudinal-data","dir":"","previous_headings":"Workflow","what":"1. Generate or load longitudinal data","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"outcome model : yij=Œ±+Œ≤xxi+Œ≤zzi+(Œ≤t+b1i)tij+Œ≤txxitij+b0i+œµijy_{ij} = \\alpha + \\beta_x x_i + \\beta_z z_i + (\\beta_t + b_{1i}) t_{ij} + \\beta_{tx} x_i t_{ij} + b_{0i} + \\epsilon_{ij} b0ib_{0i} b1ib_{1i} correlated random intercepts slopes.","code":"library(bayes2stage)  set.seed(123) data <- generate_data(   N = 1000,                    # subjects   M = 5,                       # time points per subject   x_dist = \"normal\",           # covariate distribution   beta_x = 1,                  # effect of x on outcome   beta_t_x_interaction = 0.3,  # x modifies the slope   rand_intercept_sd = 3,   rand_slope_sd = 1 )"},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"id_2-apply-a-two-stage-sampling-design","dir":"","previous_headings":"Workflow","what":"2. Apply a two-stage sampling design","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"Select 200 subjects stage 2, oversampling tails: Subjects selected x values set NA.","code":"stage2_data <- ods_design(   data,   sampling_type = \"slope\",     # sample based on estimated slopes   cutoff_low = 0.25,   cutoff_high = 0.75,   n_sampled = 200,   prop_low = 0.4,              # 40% from lowest quartile   prop_middle = 0.2,           # 20% from middle 50%   prop_high = 0.4              # 40% from highest quartile )"},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"id_3-fit-bayesian-model-with-imputation","dir":"","previous_headings":"Workflow","what":"3. Fit Bayesian model with imputation","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"Stan model jointly: Models longitudinal outcome random effects Imputes missing covariate values using observed covariates","code":"fit <- fit_stan_model(   data = stage2_data,   main_model_covariates = c(\"x\", \"z\", \"t\"),   imputation_model_covariates = c(\"z\"),   imputation_distribution = \"normal\",   n_chains = 4,   iter_warmup = 1000,   iter_sampling = 1000 )  # View results fit$summary(variables = c(\"beta_x\", \"beta_z\", \"beta_t\"))"},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"supported-covariate-distributions","dir":"","previous_headings":"","what":"Supported Covariate Distributions","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"package handles different covariate types specialized Stan models:","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"ascertainment-corrected-maximum-likelihood-acml","dir":"","previous_headings":"Alternative Estimation Methods","what":"Ascertainment-Corrected Maximum Likelihood (ACML)","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"frequentist analysis ODS designs:","code":"acml_results <- fit_acml_ods(   ods_df = stage2_data,   cutoff_low = 0.25,   cutoff_high = 0.75 )"},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"nimble-based-bayesian-fitting","dir":"","previous_headings":"Alternative Estimation Methods","what":"NIMBLE-based Bayesian fitting","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"Legacy support via fit_model() using NIMBLE probabilistic programming framework.","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"","code":"Rohde, M. (2024). bayes2stage: Bayesian Analysis of Two-Stage Designs. R package version 0.0.0.9000. https://github.com/maxdrohde/bayes2stage"},{"path":"https://maxdrohde.github.io/bayes2stage/index.html","id":"links","dir":"","previous_headings":"","what":"Links","title":"Bayesian Analysis of Two-Stage Designs with Longitudinal Data","text":"GitHub Repository Bug Reports","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":null,"dir":"","previous_headings":"","what":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Authors: [Author names] Affiliations: [Institutions] Correspondence: [Email]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"abstract","dir":"","previous_headings":"","what":"Abstract","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Longitudinal studies frequently aim understand expensive--measure covariates‚Äîbiomarkers, genetic profiles, detailed environmental exposures‚Äîshape health trajectories time. budget constraints preclude measuring every subject, researchers must decide individuals assess, ideally selecting contribute statistical information. develop Bayesian two-stage framework addresses challenge. Stage 1, inexpensive longitudinal outcomes collected subjects. Stage 2, expensive covariates measured strategically selected subset, guided Stage 1 trajectory information. framework supports three selection strategies: simple random sampling (SRS), outcome-dependent sampling (ODS) based ordinary least squares trajectory estimates, BLUP-dependent sampling (BDS) leverages mixed model predictions identify informative subjects accurately. estimation, introduce joint modeling approach combines mixed-effects outcome models flexible covariate imputation, accommodating continuous, binary, count covariates. optimized Stan implementation marginalizes discrete missing covariates analytically, avoiding mixing problems plague discrete parameter sampling. also provide frequentist ascertainment-corrected maximum likelihood (ACML) estimator comparison. Extensive simulations demonstrate tail-focused ODS BDS designs substantially improve precision covariate effects relative random sampling, BDS offering additional gains trajectory estimates unreliable. Coverage remains well-calibrated correctly specified imputation models. methods implemented open-source R package bayes2stage. Keywords: two-stage design, outcome-dependent sampling, longitudinal data, Bayesian imputation, mixed effects models, BLUP, Stan","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_1-introduction","dir":"","previous_headings":"","what":"1. Introduction","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"promise precision medicine personalized health research rests understanding individual characteristics‚Äîgenetic variants, biomarker profiles, environmental exposures‚Äîinfluence disease trajectories. Yet covariates matter often expensive measure. novel proteomic panel might cost hundreds dollars per assay; whole-genome sequencing remains significant expense; comprehensive environmental monitoring requires specialized equipment labor-intensive protocols. Meanwhile, health outcomes flow readily electronic records, routine clinical visits, inexpensive questionnaires. asymmetry cost covariates outcomes creates design challenge. Researchers cohorts thousands afford measure expensive covariates everyone, recognize measuring handful subjects yield underpowered analyses. question becomes: given fixed budget, subjects receive expensive measurements maximize learn covariate-outcome relationships? naive answer‚Äîselect subjects random‚Äîstatistically valid inefficient. subjects carry equal information covariate influences trajectories. Consider study inflammatory biomarker affects cognitive decline. subject whose cognition remains rock-steady years tells us something different one declines precipitously. biomarker truly matters, extreme responders likely informative biomarker values‚Äîeither high low. Randomly sampling subjects ignores structure, wasting measurement resources individuals whose middling trajectories reveal little biomarker‚Äôs effects. Two-stage designs formalize intuition subjects informative others. Stage 1, inexpensive longitudinal outcomes collected everyone, revealing individual trajectory patterns. Stage 2, expensive covariates measured subset selected maximally informative‚Äîoften oversampling subjects extreme trajectories. resulting data analyzed using methods properly account selective sampling. paper develops comprehensive Bayesian framework two-stage longitudinal designs. make three primary contributions. First, introduce BLUP-dependent sampling (BDS), uses mixed model predictions rather raw ordinary least squares estimates identify informative subjects. leveraging shrinkage borrowing strength across subjects, BDS accurately identifies truly extreme individuals, particularly trajectory estimates noisy. Second, develop joint Bayesian model simultaneously estimates outcome-covariate relationships imputes missing covariate values, optimized implementations continuous, binary, count covariates. Third, provide extensive simulation evidence comparing sampling strategies estimation approaches, offering practical guidance applied researchers. methods implemented R package bayes2stage, provides design functions constructing Stage 2 samples, Stan-based Bayesian estimation, frequentist ACML estimator comparison. goal make sophisticated methods accessible researchers facing ubiquitous challenge expensive covariates longitudinal research.","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_21-data-structure-and-outcome-model","dir":"","previous_headings":"2. Methods","what":"2.1 Data Structure and Outcome Model","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"consider longitudinal study NN subjects. Subject ii contributes MiM_i outcome measurements yi1,‚Ä¶,yiMiy_{i1}, \\ldots, y_{iM_i} collected times ti1,‚Ä¶,tiMit_{i1}, \\ldots, t_{iM_i}. expensive covariate xix_i, measured subset subjects, primary predictor interest. inexpensive auxiliary covariate ziz_i, available everyone, may predict outcome expensive covariate. model outcomes using linear mixed effects specification: yij=Œ±+Œ≤xxi+Œ≤zzi+(Œ≤t+b1i)tij+Œ≤txxitij+b0i+œµijy_{ij} = \\alpha + \\beta_x x_i + \\beta_z z_i + (\\beta_t + b_{1i}) t_{ij} + \\beta_{tx} x_i t_{ij} + b_{0i} + \\epsilon_{ij} fixed effects decompose follows. intercept Œ±\\alpha represents population-average outcome baseline subjects xi=zi=0x_i = z_i = 0. coefficient Œ≤x\\beta_x captures main effect expensive covariate outcome level‚Äîcentral parameter many applications. coefficient Œ≤z\\beta_z adjusts auxiliary covariate. time slope Œ≤t\\beta_t represents population-average change time, interaction Œ≤tx\\beta_{tx} allows expensive covariate modify trajectory. Œ≤tx‚â†0\\beta_{tx} \\neq 0, covariate influences just subjects start quickly change‚Äîoften scientifically interesting question. Subject-specific deviations population averages captured correlated random effects: (b0ib1i)‚àºùí©((00),Œ£=(œÉb02œÅœÉb0œÉb1œÅœÉb0œÉb1œÉb12))\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\left(\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\Sigma = \\begin{pmatrix} \\sigma_{b0}^2 & \\rho\\sigma_{b0}\\sigma_{b1} \\\\ \\rho\\sigma_{b0}\\sigma_{b1} & \\sigma_{b1}^2 \\end{pmatrix}\\right) random intercept b0ib_{0i} shifts subject ii‚Äôs entire trajectory ; random slope b1ib_{1i} tilts trajectory steeper flatter. correlation œÅ\\rho allows subjects start high also change faster (slower). Residual errors œµij‚àºùí©(0,œÉmain2)\\epsilon_{ij} \\sim \\mathcal{N}(0, \\sigma^2_{\\text{main}}) capture measurement occasion variability. Throughout, scale time unit interval improve numerical stability facilitate prior specification.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_22-stage-2-sampling-designs","dir":"","previous_headings":"2. Methods","what":"2.2 Stage 2 Sampling Designs","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"central design question subjects expensive covariate measured. consider three strategies, implemented dedicated package functions. Simple Random Sampling (SRS) selects subjects equal probability, implemented via srs_design(). approach ignores Stage 1 outcome data entirely, treating subjects equally informative. valid, SRS serves primarily baseline compare sophisticated strategies. Outcome-Dependent Sampling (ODS) exploits Stage 1 trajectories identify informative subjects. ods_design() function first estimates subject-specific intercepts slopes fitting separate ordinary least squares regressions individual‚Äôs data. Subjects stratified groups‚Äîtypically three, labeled Low, Middle, High‚Äîbased quantiles estimates. Sampling overweights tails: common allocation devotes 40% measurements Low stratum, 20% Middle, 40% High. logic straightforward. expensive covariate influences outcome levels, subjects extreme observed intercepts (accounting zz) likely extreme covariate values. Oversampling subjects concentrates measurement resources yield information Œ≤x\\beta_x. Stratification can alternatively target slopes interaction Œ≤tx\\beta_{tx} primary interest. BLUP-Dependent Sampling (BDS) refines ODS using Best Linear Unbiased Predictors mixed effects model fitted Stage 1 data, implemented via bds_design(). key insight OLS estimates treat subjects equally, even contribute observations highly variable measurements. subject two noisy data points receives extreme OLS slope may reflect measurement error rather truly unusual trajectory. BLUPs, contrast, shrink unreliable estimates toward population mean, reserving extreme predictions subjects whose data genuinely support . BDS valuable trajectory estimates unreliable‚Äîsubjects time points, measurement error substantial, -subject heterogeneity large. trajectories precisely estimated, BDS ODS converge, simpler OLS-based approach suffices.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_23-bayesian-joint-model-and-imputation","dir":"","previous_headings":"2. Methods","what":"2.3 Bayesian Joint Model and Imputation","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Stage 2 subjects selected expensive covariates measured, turn estimation. challenge xix_i missing unselected subjects. Rather discarding individuals, develop joint model leverages available data. Model Structure. specify joint distribution factoring outcome component imputation component: p(yi,xi‚à£zi,Œ∏)=p(yi‚à£xi,zi,Œ∏y)√óp(xi‚à£zi,Œ∏x)p(y_i, x_i \\mid z_i, \\theta) = p(y_i \\mid x_i, z_i, \\theta_y) \\times p(x_i \\mid z_i, \\theta_x) outcome component mixed effects model described . imputation component links expensive covariate auxiliary covariate, providing mechanism predicting xx unobserved. subjects observed xx, components contribute directly likelihood. subjects missing xx, marginalize: p(yi‚à£zi,Œ∏)=‚à´p(yi‚à£xi,zi,Œ∏y)√óp(xi‚à£zi,Œ∏x)dxip(y_i \\mid z_i, \\theta) = \\int p(y_i \\mid x_i, z_i, \\theta_y) \\times p(x_i \\mid z_i, \\theta_x) \\, dx_i integral averages possible covariate values, weighted probability imputation model. outcome data unselected subjects still contribute inference‚Äîinform random effects variance components , imputation model, covariate distribution. Imputation Model Specifications. package supports four covariate types, appropriate imputation distribution: continuous covariates (e.g., biomarker concentrations), specify normal linear regression: xi‚à£zi‚àºùí©(Œ±imp+Œ≥zi,œÉimp2)x_i \\mid z_i \\sim \\mathcal{N}(\\alpha_{\\text{imp}} + \\gamma z_i, \\sigma^2_{\\text{imp}}) binary covariates (e.g., presence genetic variant), use logistic regression: xi‚à£zi‚àºBernoulli(logit‚àí1(Œ±imp+Œ≥zi))x_i \\mid z_i \\sim \\text{Bernoulli}\\left(\\text{logit}^{-1}(\\alpha_{\\text{imp}} + \\gamma z_i)\\right) unbounded count covariates (e.g., number risk alleles), employ negative binomial model: xi‚à£zi‚àºNegBinom(Œºi=exp(Œ±imp+Œ≥zi),œï)x_i \\mid z_i \\sim \\text{NegBinom}\\left(\\mu_i = \\exp(\\alpha_{\\text{imp}} + \\gamma z_i), \\phi\\right) œï\\phi governs overdispersion. bounded count covariates (e.g., scores maximum), use beta-binomial: xi‚à£zi‚àºBetaBinom(ntrials,Œ±bb,Œ≤bb)x_i \\mid z_i \\sim \\text{BetaBinom}(n_{\\text{trials}}, \\alpha_{bb}, \\beta_{bb}) Œ±bb\\alpha_{bb} Œ≤bb\\beta_{bb} functions mean parameter concentration œï\\phi. Handling Missing Covariates. marginalization integral takes different forms depending covariate type. continuous xx, either exploit conjugacy sample latent values. discrete xx, marginalize analytically summing possible values: p(yi‚à£zi,Œ∏)=‚àëx=0xmaxp(yi‚à£xi=x,zi,Œ∏y)√óp(xi=x‚à£zi,Œ∏x)p(y_i \\mid z_i, \\theta) = \\sum_{x=0}^{x_{\\max}} p(y_i \\mid x_i = x, z_i, \\theta_y) \\times p(x_i = x \\mid z_i, \\theta_x) analytic marginalization, implemented via numerically stable log_sum_exp operations, crucial computational efficiency. Treating discrete missing values parameters sampled leads poor mixing; marginalizing yields smooth likelihood surface Hamiltonian Monte Carlo explores efficiently. Prior Specification. assign weakly informative priors throughout. Scale parameters (standard deviations, dispersion) receive exponential priors rate 0.1, gently favoring smaller values permitting large estimates warranted. Fixed effects outcome model receive diffuse ùí©(0,1002)\\mathcal{N}(0, 100^2) priors. Imputation model coefficients logit log scale receive ùí©(0,2.52)\\mathcal{N}(0, 2.5^2) priors, providing mild regularization. random effects correlation matrix receives LKJ(2) prior, expressing modest skepticism toward extreme correlations. Computational Implementation. Stan models employ several optimizations. Random effects use non-centered parameterization‚Äîwriting bi=diag(œÉb)Lzib_i = \\text{diag}(\\sigma_b) L z_i zi‚àºùí©(0,)z_i \\sim \\mathcal{N}(0, ) LL Cholesky factor‚Äîavoid pathological posterior geometries common hierarchical models. Likelihood calculations vectorized across observations, precomputed index arrays (id, pos, len) enabling efficient subject-wise operations. Discrete covariate marginalization precomputes sufficient statistics avoid redundant calculations across summation. Diagnostics. monitor standard MCMC diagnostics: RÃÇ\\hat{R} statistics convergence, effective sample sizes mixing efficiency, divergent transitions geometric pathologies, energy Bayesian fraction missing information (E-BFMI) adequate exploration. Posterior predictive checks assess model fit outcomes imputed covariates.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_24-frequentist-comparator-ascertainment-corrected-maximum-likelihood","dir":"","previous_headings":"2. Methods","what":"2.4 Frequentist Comparator: Ascertainment-Corrected Maximum Likelihood","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"contextualize Bayesian estimates, also implement frequentist estimation via ascertainment-corrected maximum likelihood (ACML), available fit_acml_ods() ODS designs. core idea adjust likelihood outcome-dependent selection. ODS, subjects different strata different selection probabilities, ignoring structure biases inference. ACML corrects weighting subject‚Äôs contribution inversely selection probability: LiACML(Œ∏)=p(yi‚à£xi,zi,Œ∏y)√óp(xi‚à£zi,Œ∏x)P(‚ààùíÆ‚à£yi,zi,Œ∏)L_i^{\\text{ACML}}(\\theta) = \\frac{p(y_i \\mid x_i, z_i, \\theta_y) \\times p(x_i \\mid z_i, \\theta_x)}{P(\\\\mathcal{S} \\mid y_i, z_i, \\theta)} denominator‚Äîascertainment probability‚Äîcomputed known sampling design stratum definitions. Standard errors come robust sandwich estimation. ACML provides useful benchmark. faster MCMC-based Bayesian inference relies different assumptions (correct likelihood specification rather correct priors). Agreement Bayesian ACML estimates provides reassurance; disagreement prompts investigation.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_25-computational-considerations","dir":"","previous_headings":"2. Methods","what":"2.5 Computational Considerations","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Practical application requires attention computational details. Stan implementations src/stan/ optimized specific likelihood structures arising two-stage designs. Vectorized operations process observations efficiently; subject-wise sufficient statistics avoid redundant calculations marginalization sums; non-centered random effects improve sampling geometry. recommend running multiple chains (typically four) assess convergence adjusting adapt_delta upward (0.95 higher) divergent transitions occur. reproducibility across simulation studies, use Cantor pairing generate unique seeds simulation cell, ensuring results can exactly replicated.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_3-simulation-study","dir":"","previous_headings":"","what":"3. Simulation Study","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"conducted extensive simulations evaluate much strategic sampling improves inference, characterize operating characteristics Bayesian estimator.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_31-goals","dir":"","previous_headings":"3. Simulation Study","what":"3.1 Goals","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"simulations address five questions: Efficiency gains: much ODS BDS improve precision Œ≤x\\beta_x Œ≤tx\\beta_{tx} relative SRS? BDS versus ODS: conditions BLUP-based sampling outperform OLS-based sampling? Coverage calibration: credible intervals achieve nominal coverage correct model specification? Robustness: performance degrade imputation model misspecified? Cost-effectiveness: precision scale fraction subjects measured?","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_32-data-generation","dir":"","previous_headings":"3. Simulation Study","what":"3.2 Data Generation","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"generated data using generate_data() across factorial design spanning realistic scenarios: Sample sizes: N‚àà{500,1000,2000}N \\\\{500, 1000, 2000\\}, representing moderate large longitudinal cohorts. Time points: M‚àà{3,5,8}M \\\\{3, 5, 8\\} observations per subject, spanning sparse moderately dense follow-. Random effects structure: Standard deviations œÉb0,œÉb1‚àà{1,2,4}\\sigma_{b0}, \\sigma_{b1} \\\\{1, 2, 4\\} correlations œÅ‚àà{0,0.3,0.6}\\rho \\\\{0, 0.3, 0.6\\}, capturing varying degrees -subject heterogeneity. Residual variation: œÉmain‚àà{1,2,4}\\sigma_{\\text{main}} \\\\{1, 2, 4\\}, representing low high measurement noise. Effect sizes: Œ≤x‚àà{0,0.3,0.6,1.0}\\beta_x \\\\{0, 0.3, 0.6, 1.0\\} main effect; Œ≤tx‚àà{0,0.2,0.4}\\beta_{tx} \\\\{0, 0.2, 0.4\\} interaction. Null effects (Œ≤x=0\\beta_x = 0 Œ≤tx=0\\beta_{tx} = 0) allow assessment type error. Covariate types: Continuous (normal), binary (Bernoulli p‚àà{0.2,0.5}p \\\\{0.2, 0.5\\}), count (negative binomial beta-binomial varying dispersion). Auxiliary covariate strength: coefficient Œ≥\\gamma linking zz xx varied across weak (0.2), moderate (0.6), strong (1.0) associations. Stronger associations improve imputation accuracy.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_33-design-factors","dir":"","previous_headings":"3. Simulation Study","what":"3.3 Design Factors","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Within data-generating scenario, varied sampling design: Sampling fractions: 5%, 10%, 20%, 40% subjects received expensive covariate measurement, spanning severely constrained moderately generous budgets. Stratification: used tertile-based strata cutoffs 20th/80th 25th/75th percentiles. Allocation Low/Middle/High strata either symmetric (33%/33%/33%) tail-heavy (40%/20%/40%). Design types: SRS, ODS-intercept, ODS-slope, BDS-intercept, BDS-slope. Misspecification scenarios: stress-test robustness, examined designs stratified slopes Œ≤tx=0\\beta_{tx} = 0 (stratifying irrelevant quantity), models fitting wrong imputation family (e.g., normal imputation count data).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_34-estimators-and-metrics","dir":"","previous_headings":"3. Simulation Study","what":"3.4 Estimators and Metrics","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"compared five estimators: Bayesian joint model correct imputation specification Bayesian joint model misspecified imputation ACML ODS designs Naive complete-case analysis using subjects observed xx Oracle xx observed subjects (infeasible benchmark) estimator scenario, recorded: Bias: Average deviation point estimates true values RMSE: Root mean squared error combining bias variance Interval width: Average width 95% credible confidence intervals Coverage: Proportion intervals containing true value Power: Proportion intervals excluding zero true effect non-null Type error: Proportion intervals excluding zero true effect null Relative efficiency: Variance ratio relative SRS (design comparisons) oracle (absolute efficiency) Imputation accuracy: Mean absolute error calibration imputed xx values Cost-adjusted precision: Precision per unit cost, accounting Stage 2 measurement expenses Computational performance: Runtime, effective sample size per second, divergent transition counts ran least 500 replications per scenario ensure stable estimates operating characteristics.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_35-hypotheses","dir":"","previous_headings":"3. Simulation Study","what":"3.5 Hypotheses","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Based theoretical considerations, anticipated: ODS BDS reduce RMSE narrow intervals Œ≤x\\beta_x relative SRS, gains largest moderate effect sizes 10‚Äì30% sampling fractions. BDS outperform ODS trajectory estimates unreliable: fewer time points, larger residual variance, larger random effects variance (increases BLUP shrinkage). Coverage near nominal (95%) correct imputation specification degrade misspecification, particularly discrete covariates. Cost-adjusted efficiency plateau beyond 20‚Äì30% sampling, diminishing returns additional measurements.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_4-results","dir":"","previous_headings":"","what":"4. Results","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[section populated simulation results. following structure placeholder tables indicate planned presentation.]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_41-primary-comparison-sampling-strategy-effects","dir":"","previous_headings":"4. Results","what":"4.1 Primary Comparison: Sampling Strategy Effects","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Table 1 summarizes bias, RMSE, coverage Œ≤x\\beta_x across sampling designs 20% selection. Table 1. Performance estimating Œ≤x\\beta_x sampling design (N=1000N = 1000, M=5M = 5, 20% selection, true Œ≤x=1.0\\beta_x = 1.0) Key findings: methods showed negligible bias. ODS BDS achieved [XX‚ÄìXX]% efficiency gains SRS. BDS-intercept outperformed ODS-intercept [XX]%, advantage concentrated scenarios noisy trajectory estimates.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_42-cost-efficiency-tradeoff","dir":"","previous_headings":"4. Results","what":"4.2 Cost-Efficiency Tradeoff","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Figure 1 displays relative efficiency function sampling fraction. [PLACEHOLDER: Figure 1] ‚Äî Efficiency curves showing precision relative oracle across sampling fractions (5%‚Äì40%) SRS, ODS, BDS designs. Key findings: Strategic sampling provided largest relative gains low sampling fractions. 10% selection, BDS achieved [XX]% oracle efficiency versus [XX]% SRS. Gains diminished 30% selection, methods approached oracle performance.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_43-when-does-bds-outperform-ods","dir":"","previous_headings":"4. Results","what":"4.3 When Does BDS Outperform ODS?","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Figure 2 examines BDS advantage across data characteristics. [PLACEHOLDER: Figure 2] ‚Äî Panels showing BDS vs.¬†ODS relative efficiency () number time points, (B) residual variance, (C) random effects variance. Key findings: BDS gains largest time points (M=3M = 3: [XX]% advantage), high residual variance (œÉ=4\\sigma = 4: [XX]% advantage), large -subject heterogeneity. M=8M = 8 low noise, BDS ODS performed similarly.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_44-bayesian-vs-acml-estimation","dir":"","previous_headings":"4. Results","what":"4.4 Bayesian vs.¬†ACML Estimation","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Table 2 compares estimation approaches. Table 2. Comparison Bayesian ACML estimation (ODS-intercept, 20% selection) Key findings: methods essentially unbiased. Bayesian coverage closer nominal smaller samples. ACML approximately [XX]√ó faster.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_45-covariate-type-performance","dir":"","previous_headings":"4. Results","what":"4.5 Covariate Type Performance","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Table 3 presents results across covariate distributions. Table 3. Performance covariate type (BDS-intercept, 20% selection, N=1000N = 1000) Key findings: covariate types achieved valid coverage. Efficiency gains BDS comparable across types, slightly attenuated gains binary covariates due discreteness.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_46-robustness-to-misspecification","dir":"","previous_headings":"4. Results","what":"4.6 Robustness to Misspecification","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Table 4 examines imputation model misspecification. Table 4. Effect imputation model misspecification Key findings: Moderate misspecification (fitting normal mixture normal) limited impact. Severe misspecification (fitting normal counts) degraded coverage [XX]%, though bias remained modest.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_47-summary-of-simulation-findings","dir":"","previous_headings":"4. Results","what":"4.7 Summary of Simulation Findings","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"simulations support four main conclusions: Strategic sampling improves efficiency: ODS BDS reduce RMSE covariate effects [XX‚ÄìXX]% relative SRS, benefits concentrated 10‚Äì30% sampling fractions. BDS outperforms ODS trajectories noisy: BLUP-based approach provides additional gains individual trajectory estimates unreliable. Inference well-calibrated: Coverage remains near nominal correct specification, Bayesian methods showing advantages small samples. Robustness moderate: Mild imputation misspecification limited impact, severe misspecification warrants sensitivity analysis.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_5-case-study","dir":"","previous_headings":"","what":"5. Case Study","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[section present applied example demonstrating complete workflow.]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_51-study-description","dir":"","previous_headings":"5. Case Study","what":"5.1 Study Description","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[Describe motivating application: scientific question, cohort characteristics, expensive covariate, available longitudinal outcomes, auxiliary covariates.]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_52-design-construction","dir":"","previous_headings":"5. Case Study","what":"5.2 Design Construction","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[Apply ods_design() bds_design() construct Stage 2 sample. Report stratification variable, cutoffs, stratum sizes, achieved sampling fraction.]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_53-model-fitting","dir":"","previous_headings":"5. Case Study","what":"5.3 Model Fitting","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[Fit Bayesian joint model via fit_stan_model() appropriate covariate type. ODS, also fit ACML comparison. Report convergence diagnostics.]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_54-results","dir":"","previous_headings":"5. Case Study","what":"5.4 Results","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[Present effect estimates credible intervals. Include posterior predictive checks outcomes imputed covariates. Visualize selection: density plots stratification variable cutoff lines, trajectory plots sampled vs.¬†unsampled subjects.]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_55-interpretation","dir":"","previous_headings":"5. Case Study","what":"5.5 Interpretation","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[Discuss scientific implications estimated covariate effects. Address practical considerations: cost savings achieved, limitations analysis, recommendations future studies.]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_6-discussion","dir":"","previous_headings":"","what":"6. Discussion","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Two-stage designs offer principled solution common challenge expensive covariates longitudinal research. measuring expensive variables strategically selected subjects properly modeling resulting missing data, researchers can achieve substantial efficiency gains maintaining valid inference.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"key-findings","dir":"","previous_headings":"6. Discussion","what":"Key Findings","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Bayesian framework, combining mixed-effects outcome models flexible covariate imputation, provides well-calibrated uncertainty quantification across diverse scenarios. Tail-focused ODS BDS strategies consistently outperform simple random sampling, efficiency gains [XX‚ÄìXX]% typical sampling fractions. magnitude gains depends effect size, sampling fraction, data characteristics, meaningful improvements achievable across realistic settings. BLUP-dependent sampling offers additional advantages individual trajectory estimates unreliable. shrinking noisy estimates toward population mean, BDS avoids misclassification average subjects extreme can plague OLS-based approaches. benefits largest time points, high measurement error, substantial -subject heterogeneity‚Äîprecisely conditions efficient design matters .","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"practical-recommendations","dir":"","previous_headings":"6. Discussion","what":"Practical Recommendations","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"applied researchers, offer several recommendations: Choosing ODS BDS: subjects contribute many precise observations (M‚â•5M \\geq 5, low œÉ\\sigma), OLS-based ODS simpler performs nearly well BDS. sparse noisy data, BDS provides meaningful additional efficiency. Selecting sampling fraction: 20% fraction often balances cost precision well. 10%, even strategic sampling yields limited information; 30%, gains strategic selection diminish relative simpler designs. Stratification variable: Target intercepts main effect Œ≤x\\beta_x primary; target slopes interaction Œ≤tx\\beta_{tx} matters . Imputation model: Match distributional family covariate type. uncertain, sensitivity analyses alternative specifications advisable.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"limitations","dir":"","previous_headings":"6. Discussion","what":"Limitations","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Several limitations warrant acknowledgment. methods assume missingness random conditional observed data‚Äîselection depends outcomes auxiliary covariates, unobserved expensive covariate . Violations occur subjects extreme covariate values differentially difficult recruit. imputation model must least approximately correctly specified; severe misspecification degrades coverage. assume linear trajectories; non-linear patterns require model extensions. expensive covariate time-invariant (measured baseline); time-varying expensive measurements require additional methodology. Finally, computation scales sample size despite optimizations.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"future-directions","dir":"","previous_headings":"6. Discussion","what":"Future Directions","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Several extensions merit investigation. Time-varying expensive covariates‚Äîcostly measurement repeated selected occasions‚Äîarise naturally biomarker monitoring. Non-linear trajectories, modeled splines Gaussian processes, accommodate complex longitudinal patterns. Informative dropout, missingness outcomes depends unobserved health status, common aging cohorts. Adaptive designs update selection probabilities sequentially data accumulate improve efficiency. Finally, scalable computation variational approximations GPU acceleration extend applicability large cohorts.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_7-software-and-reproducibility","dir":"","previous_headings":"","what":"7. Software and Reproducibility","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"methods implemented R package bayes2stage, available [GitHub URL]. package provides: Design functions: srs_design(), ods_design(), bds_design() constructing Stage 2 samples Estimation: fit_stan_model() Bayesian inference; fit_acml_ods() frequentist ACML Simulation: generate_data() generating synthetic longitudinal data Diagnostics: Functions MCMC assessment, posterior summaries, visualization Stan models reside src/stan/, separate implementations covariate type. package vignette (vignettes/bayes2stage.qmd) provides tutorial walking complete workflow. reproducibility, simulation scripts include fixed seeds using Cantor pairing unique per-cell randomization. recommend using renv containerization ensure consistent package versions.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_8-acknowledgments","dir":"","previous_headings":"","what":"8. Acknowledgments","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[Insert funding sources, collaborator acknowledgments, data access statements.]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"id_9-references","dir":"","previous_headings":"","what":"9. References","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"Betancourt, M. (2017). conceptual introduction Hamiltonian Monte Carlo. arXiv preprint arXiv:1701.02434. Breslow, N. E., Chatterjee, N. (1999). Design analysis two-phase studies binary outcome applied Wilms tumour prognosis. Journal Royal Statistical Society: Series C, 48, 457‚Äì468. Carpenter, B., Gelman, ., Hoffman, M. D., Lee, D., Goodrich, B., Betancourt, M., Brubaker, M., Guo, J., Li, P., Riddell, . (2017). Stan: probabilistic programming language. Journal Statistical Software, 76(1), 1‚Äì32. Little, R. J., Rubin, D. B. (2019). Statistical Analysis Missing Data (3rd ed.). Wiley. Schildcrout, J. S., Rathouz, P. J. (2010). Longitudinal studies binary response data following case-control stratified case-control sampling: Design analysis. Biometrics, 66, 365‚Äì373. Weaver, M. ., Zhou, H. (2005). estimated likelihood method continuous outcome regression models outcome-dependent sampling. Journal American Statistical Association, 100, 459‚Äì469. Zhou, H., Weaver, M. ., Qin, J., Longnecker, M. P., Wang, M. C. (2002). semiparametric empirical likelihood method data outcome-dependent sampling scheme continuous outcome. Biometrics, 58, 413‚Äì421.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"appendix-a-stan-model-implementation-details","dir":"","previous_headings":"","what":"Appendix A: Stan Model Implementation Details","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[Technical details Stan implementations, including non-centered parameterization, marginalization strategy discrete covariates, vectorization approach.]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"appendix-b-additional-simulation-results","dir":"","previous_headings":"","what":"Appendix B: Additional Simulation Results","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[Extended tables presenting results parameter combinations, including Œ≤z\\beta_z, Œ≤t\\beta_t, Œ≤tx\\beta_{tx}, variance components.]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_draft.html","id":"appendix-c-sensitivity-analyses","dir":"","previous_headings":"","what":"Appendix C: Sensitivity Analyses","title":"Bayesian Two-Stage Designs for Longitudinal Studies with Costly Covariates","text":"[Results alternative prior specifications, varying adapt_delta, different stratification cutoffs.] Manuscript prepared R Markdown. Reproducible code available [repository URL].","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"working-title-options","dir":"","previous_headings":"","what":"Working Title Options","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"‚ÄúBayesian Two-Stage Designs Longitudinal Studies: Efficient Estimation Covariates Expensive Measure‚Äù ‚ÄúBLUP-Dependent Sampling Longitudinal Studies: Bayesian Imputation Approach‚Äù ‚ÄúCost-Effective Longitudinal Study Design Using Outcome-Dependent Sampling Bayesian Imputation‚Äù","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_11-the-problem","dir":"","previous_headings":"1. Introduction and Motivation","what":"1.1 The Problem","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Many longitudinal studies require measurement expensive covariates (biomarkers, genetic tests, environmental exposures) Measuring subjects often cost-prohibitive Key question: can design studies maximize statistical efficiency minimizing measurement costs?","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_12-motivating-examples","dir":"","previous_headings":"1. Introduction and Motivation","what":"1.2 Motivating Examples","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Biomarker studies: Expensive assays (e.g., proteomics, metabolomics) longitudinal cohorts Genetic studies: Whole-genome sequencing costs subset epidemiological cohort Environmental health: Personal exposure monitoring (e.g., air pollution sensors) labor-intensive Clinical trials: Collecting expensive imaging invasive secondary endpoints","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_13-existing-approaches","dir":"","previous_headings":"1. Introduction and Motivation","what":"1.3 Existing Approaches","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Simple random sampling (SRS) subjects expensive measurement Case-control designs (binary outcomes) Outcome-dependent sampling (ODS) cross-sectional studies Gap: Limited methods longitudinal data continuous outcomes trajectory-based sampling","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_14-our-contribution","dir":"","previous_headings":"1. Introduction and Motivation","what":"1.4 Our Contribution","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Extension ODS longitudinal settings using trajectory characteristics Novel BLUP-dependent sampling (BDS) leverages mixed model estimates Bayesian imputation framework jointly models outcomes missing covariates Comparison ascertainment-corrected maximum likelihood (ACML) Flexible framework supporting different covariate distributions (normal, binary, count)","code":""},{"path":[]},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_211-data-structure","dir":"","previous_headings":"2. Methods > 2.1 Study Design and Notation","what":"2.1.1 Data Structure","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"N subjects, nin_i longitudinal observations yijy_{ij}: outcome subject ii time tijt_{ij} xix_i: expensive covariate (measured subset) ziz_i: inexpensive covariate (measured )","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_212-two-stage-design","dir":"","previous_headings":"2. Methods > 2.1 Study Design and Notation","what":"2.1.2 Two-Stage Design","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Stage 1: Collect (yij,zi,tij)(y_{ij}, z_i, t_{ij}) N subjects Stage 2: Select n2<Nn_2 < N subjects expensive covariate measurement based Stage 1 data","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_22-outcome-model","dir":"","previous_headings":"2. Methods","what":"2.2 Outcome Model","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Present mixed effects model: yij=Œ±+Œ≤xxi+Œ≤zzi+(Œ≤t+b1i)tij+Œ≤xtxitij+b0i+œµijy_{ij} = \\alpha + \\beta_x x_i + \\beta_z z_i + (\\beta_t + b_{1i}) t_{ij} + \\beta_{xt} x_i t_{ij} + b_{0i} + \\epsilon_{ij} : - (b0i,b1i)‚Ä≤‚àºN(0,Œ£b)(b_{0i}, b_{1i})' \\sim N(0, \\Sigma_b): correlated random effects - œµij‚àºN(0,œÉ2)\\epsilon_{ij} \\sim N(0, \\sigma^2): residual error","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_231-simple-random-sampling-srs","dir":"","previous_headings":"2. Methods > 2.3 Sampling Strategies","what":"2.3.1 Simple Random Sampling (SRS)","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Baseline comparator Select n2n_2 subjects uniformly random","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_232-outcome-dependent-sampling-ods","dir":"","previous_headings":"2. Methods > 2.3 Sampling Strategies","what":"2.3.2 Outcome-Dependent Sampling (ODS)","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Estimate subject trajectories using OLS Stage 1 data Compute empirical BLUPs: bÃÇ0i\\hat{b}_{0i} (intercept) bÃÇ1i\\hat{b}_{1i} (slope) Stratify L (low), M (middle), H (high) tertiles Oversample tails (e.g., 40% L, 20% M, 40% H)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_233-blup-dependent-sampling-bds","dir":"","previous_headings":"2. Methods > 2.3 Sampling Strategies","what":"2.3.3 BLUP-Dependent Sampling (BDS)","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Fit mixed effects model Stage 1 data (ignoring xx) Extract conditional BLUPs accounting correlation structure Stratify sample ODS Hypothesis: efficient ODS due shrinkage","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_241-bayesian-imputation","dir":"","previous_headings":"2. Methods > 2.4 Estimation Approaches","what":"2.4.1 Bayesian Imputation","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Joint model: p(y,x|z,Œ∏)=p(y|x,z,Œ∏y)√óp(x|z,Œ∏x)p(y, x | z, \\theta) = p(y | x, z, \\theta_y) \\times p(x | z, \\theta_x) Imputation model: xi‚àºf(x|zi,Œ∏x)x_i \\sim f(x | z_i, \\theta_x) distribution-specific forms missing xix_i: marginalize plausible values Stan implementation efficient computation strategies","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_242-ascertainment-corrected-maximum-likelihood-acml","dir":"","previous_headings":"2. Methods > 2.4 Estimation Approaches","what":"2.4.2 Ascertainment-Corrected Maximum Likelihood (ACML)","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Correct biased sampling via ascertainment probability LACML=‚àè‚ààSp(yi|xi)p(xi|zi)ACiL_{ACML} = \\prod_{\\S} \\frac{p(y_i | x_i) p(x_i | z_i)}{AC_i} Robust sandwich variance estimation","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_25-imputation-model-specifications","dir":"","previous_headings":"2. Methods","what":"2.5 Imputation Model Specifications","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Normal: xi‚àºN(Œ±imp+Œ≥zi,œÉimp2)x_i \\sim N(\\alpha_{imp} + \\gamma z_i, \\sigma_{imp}^2) Bernoulli: xi‚àºBernoulli(logit‚àí1(Œ±imp+Œ≥zi))x_i \\sim Bernoulli(\\text{logit}^{-1}(\\alpha_{imp} + \\gamma z_i)) Negative Binomial: xi‚àºNegBinom(Œº=exp(Œ±imp+Œ≥zi),œï)x_i \\sim NegBinom(\\mu = \\exp(\\alpha_{imp} + \\gamma z_i), \\phi) Beta-Binomial: bounded counts overdispersion","code":""},{"path":[]},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_32-primary-simulation-comparing-sampling-strategies","dir":"","previous_headings":"3. Simulation Studies","what":"3.2 Primary Simulation: Comparing Sampling Strategies","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Objective: Demonstrate efficiency gains ODS/BDS SRS Setup: - N = 1000 subjects, 5 time points - True parameters: Œ±=2\\alpha = 2, Œ≤x=1\\beta_x = 1, Œ≤z=0.5\\beta_z = 0.5, Œ≤t=0.3\\beta_t = 0.3, Œ≤xt=0.2\\beta_{xt} = 0.2 - Random effects: œÉb0=1\\sigma_{b0} = 1, œÉb1=0.3\\sigma_{b1} = 0.3, œÅ=0.3\\rho = 0.3 - Select 20% subjects (n = 200) Metrics: - Bias: E[Œ≤ÃÇx]‚àíŒ≤xE[\\hat{\\beta}_x] - \\beta_x - RMSE: E[(Œ≤ÃÇx‚àíŒ≤x)2]\\sqrt{E[(\\hat{\\beta}_x - \\beta_x)^2]} - Coverage: 95% CI coverage probability - Relative efficiency: VarSRS(Œ≤ÃÇx)/Varmethod(Œ≤ÃÇx)\\text{Var}_{SRS}(\\hat{\\beta}_x) / \\text{Var}_{method}(\\hat{\\beta}_x) Visualizations: - Box plots parameter estimates across methods - Efficiency curves function selection fraction - Coverage probability plots","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_33-simulation-2-ods-vs-bds-comparison","dir":"","previous_headings":"3. Simulation Studies","what":"3.3 Simulation 2: ODS vs.¬†BDS Comparison","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Objective: BLUP-dependent sampling outperform OLS-based ODS? Factors: - ICC (intraclass correlation): 0.1, 0.3, 0.5, 0.7 - Number time points: 3, 5, 10 - Measurement error variance: low, medium, high Hypothesis: BDS advantage increases : - Higher ICC (borrowing across subjects) - Fewer time points (shrinkage benefit) - Higher measurement error (regularization benefit)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_34-simulation-3-bayesian-vs-acml-estimation","dir":"","previous_headings":"3. Simulation Studies","what":"3.4 Simulation 3: Bayesian vs.¬†ACML Estimation","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Objective: Compare frequentist Bayesian approaches Metrics: - Bias efficiency () - Computational time - Behavior small samples (n = 100, 200) - Sensitivity prior specification Visualization: - Side--side forest plots estimates - Posterior distributions vs.¬†asymptotic confidence intervals","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_35-simulation-4-covariate-distribution-misspecification","dir":"","previous_headings":"3. Simulation Studies","what":"3.5 Simulation 4: Covariate Distribution Misspecification","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Objective: Robustness imputation model wrong Scenarios: - True: Normal ‚Üí Fitted: Normal (baseline) - True: Mixture normals ‚Üí Fitted: Normal - True: Log-normal ‚Üí Fitted: Normal - True: Zero-inflated Poisson ‚Üí Fitted: Negative Binomial Metrics: Bias coverage degradation","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_36-simulation-5-sensitivity-to-sampling-fraction","dir":"","previous_headings":"3. Simulation Studies","what":"3.6 Simulation 5: Sensitivity to Sampling Fraction","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Objective: low can go? Selection fractions: 5%, 10%, 15%, 20%, 30%, 50%, 100% Key question: point ODS/BDS efficiency gain outweigh information loss measuring subjects?","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_37-simulation-6-interaction-effect-focus","dir":"","previous_headings":"3. Simulation Studies","what":"3.7 Simulation 6: Interaction Effect Focus","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Objective: Efficiency detecting covariate--time interaction (Œ≤xt\\beta_{xt}) Rationale: Interaction effects often require larger samples; can ODS/BDS help? Comparison: Power curves detecting non-zero Œ≤xt\\beta_{xt} across methods","code":""},{"path":[]},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_42-figure-concepts","dir":"","previous_headings":"4. Results Presentation Ideas","what":"4.2 Figure Concepts","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Figure 1: Conceptual Diagram - Schematic two-stage design - Show stratification sampling tails - Intuition tail sampling informative Figure 2: Efficiency Gains Plot - X-axis: Selection fraction (10%-50%) - Y-axis: Relative efficiency vs.¬†SRS - Lines ODS-int, ODS-slope, BDS-int, BDS-slope - Horizontal line 1.0 (SRS reference) Figure 3: Bias-Variance Trade-- Panel : Bias across methods - Panel B: Variance across methods - Panel C: RMSE (combined) Figure 4: Coverage Probability - Nominal 95% coverage line - Bar plot showing empirical coverage method Figure 5: Posterior Comparison (Bayesian) - Single simulation run - Overlay posterior densities key parameters - Compare imputed vs.¬†observed-analysis Figure 6: Computational Comparison - Timing benchmarks: Bayesian vs.¬†ACML - Scaling N number time points Figure 7: Robustness Analysis - Heatmap: Bias model misspecification scenarios - Rows: True distribution; Columns: Fitted distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_43-supplementary-figures","dir":"","previous_headings":"4. Results Presentation Ideas","what":"4.3 Supplementary Figures","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"MCMC diagnostics (trace plots, R-hat values) Prior sensitivity analysis Additional parameter estimates (Œ≤z\\beta_z, Œ≤t\\beta_t, random effects variances)","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_51-key-findings-anticipated","dir":"","previous_headings":"5. Discussion Points","what":"5.1 Key Findings (anticipated)","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"ODS BDS achieve 20-40% efficiency gains SRS main covariate effect BDS outperforms ODS ICC high time points sparse Bayesian imputation provides valid inference appropriate uncertainty quantification ACML offers computational advantages large datasets","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_52-practical-recommendations","dir":"","previous_headings":"5. Discussion Points","what":"5.2 Practical Recommendations","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"use ODS vs.¬†BDS Recommended minimum selection fractions Choice stratification variable (intercept vs.¬†slope) Handling covariate distribution uncertainty","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_53-limitations","dir":"","previous_headings":"5. Discussion Points","what":"5.3 Limitations","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Assumes MAR (missing random) conditional observed data Requires specification imputation model Computational demands Bayesian approach Sensitivity stratification boundary choices","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_54-extensions-and-future-work","dir":"","previous_headings":"5. Discussion Points","what":"5.4 Extensions and Future Work","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Multivariate expensive covariates Time-varying expensive covariates Non-linear trajectories Survival outcomes Adaptive designs (sequential sampling)","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_61-package-description","dir":"","previous_headings":"6. Software Section","what":"6.1 Package Description","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"R package bayes2stage available GitHub Depends Stan (via instantiate) Bayesian computation Reproducible examples vignette","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"id_62-code-availability","dir":"","previous_headings":"6. Software Section","what":"6.2 Code Availability","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Simulation code supplementary materials Documented API examples","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"a-technical-details","dir":"","previous_headings":"7. Appendix Ideas","what":"A. Technical Details","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Full Stan model specification Derivation ACML likelihood Proof asymptotic properties (applicable)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"b-additional-simulation-results","dir":"","previous_headings":"7. Appendix Ideas","what":"B. Additional Simulation Results","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Full tables parameters Sensitivity analyses Convergence diagnostics","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"c-real-data-application-optional","dir":"","previous_headings":"7. Appendix Ideas","what":"C. Real Data Application (Optional)","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"available: Apply motivating dataset Compare sampling strategies retrospectively","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"high-priority-simulations","dir":"","previous_headings":"Timeline and Priority","what":"High Priority Simulations","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Primary comparison (SRS vs.¬†ODS vs.¬†BDS) - Core result Selection fraction sensitivity - Practical guidance Bayesian vs.¬†ACML comparison - Method validation","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"medium-priority","dir":"","previous_headings":"Timeline and Priority","what":"Medium Priority","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"ODS vs.¬†BDS detailed comparison Covariate distribution variants","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"lower-priority-if-time-permits","dir":"","previous_headings":"Timeline and Priority","what":"Lower Priority (if time permits)","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Model misspecification robustness Interaction effect power analysis","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"key-messages-to-convey","dir":"","previous_headings":"","what":"Key Messages to Convey","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Cost savings achievable: Measuring 20% subjects smart sampling can achieve 80%+ efficiency full data Trajectory-based sampling intuitive: Oversampling extreme responders informative covariate effects Bayesian imputation handles uncertainty properly: Unlike complete-case analysis, accounts missing data mechanism BDS novel often superior: Leveraging mixed model machinery improves simple OLS-based ODS Practical software available: bayes2stage package makes methods accessible","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/paper_outline.html","id":"references-to-include","dir":"","previous_headings":"","what":"References to Include","title":"Paper Outline: Two-Stage Bayesian Methods for Cost-Effective Longitudinal Studies with Expensive Covariates","text":"Outcome-dependent sampling: Zhou et al., Biometrics literature Two-phase designs: Breslow & Chatterjee Bayesian missing data: Little & Rubin Stan HMC: Carpenter et al., Stan Development Team Mixed effects models: Laird & Ware, Verbeke & Molenberghs","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi1q.html","id":null,"dir":"Reference","previous_headings":"","what":"Ascertainment correction piece for univariate sampling ‚Äî ACi1q","title":"Ascertainment correction piece for univariate sampling ‚Äî ACi1q","text":"Calculate (yet log transformed) ascertainment correction univariate Q_i","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi1q.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ascertainment correction piece for univariate sampling ‚Äî ACi1q","text":"","code":"ACi1q(cutpoints, SampProb, mu_q, sigma_q)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi1q.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ascertainment correction piece for univariate sampling ‚Äî ACi1q","text":"cutpoints cutpoints defining sampling regions. (vector length 2) SampProb Sampling probabilities within region (vector length 3). mu_q scalar mean value Q_i distribution sigma_q scalar standard deviation Q_i distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi1q.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ascertainment correction piece for univariate sampling ‚Äî ACi1q","text":"yet log transformed ascertainment correction","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi2q.html","id":null,"dir":"Reference","previous_headings":"","what":"Ascertainment correction piece for bivariate sampling ‚Äî ACi2q","title":"Ascertainment correction piece for bivariate sampling ‚Äî ACi2q","text":"Calculate (yet log transformed) ascertainment correction bivariate Q_i","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi2q.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ascertainment correction piece for bivariate sampling ‚Äî ACi2q","text":"","code":"ACi2q(cutpoints, SampProb, mu_q, sigma_q)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi2q.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ascertainment correction piece for bivariate sampling ‚Äî ACi2q","text":"cutpoints cutpoints defining sampling regions. (vector length 4: c(xlow, xhigh, ylow, yhigh)) SampProb Sampling probabilities within two sampling regions; central region outlying region (vector length 2). mu_q 2-vector mean value bivariate Q_i distribution. sigma_q 2 2 covariance matrix bivariate Q_i distribution.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ACi2q.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ascertainment correction piece for bivariate sampling ‚Äî ACi2q","text":"yet log transformed ascertainment correction","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/CreateSubjectData.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a list of subject-specific data ‚Äî CreateSubjectData","title":"Create a list of subject-specific data ‚Äî CreateSubjectData","text":"Create list subject-specific data","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/CreateSubjectData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a list of subject-specific data ‚Äî CreateSubjectData","text":"","code":"CreateSubjectData(id, y, x, z, Weights, SampProb, cutpoints, w.function)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/CreateSubjectData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a list of subject-specific data ‚Äî CreateSubjectData","text":"id sum(n_i) vector subject ids y response vector x sum(n_i) p design matrix fixed effects z sum(n_i) 2 design matric random effects (intercept slope) Weights Subject specific sampling weights.  vector length sum(n_i).  used unless using weighted Likelihood SampProb matrix first dimension equal sum(n_i).   Sampling probabilities within region (bivariate Q_i: row vector length 2 c(central region, outlying region); univariate Q_i: row vector length 3 sampling probabilities region). subject n_i rows values. cutpoints matrix first dimension equal sum(n_i).  cutpoints define sampling regions (bivariate Q_i: row vector length 4 c(xlow, xhigh, ylow, yhigh); univariate Q_i: row vector length 2 c(k1,k2) define sampling regions, .e., low, middle, high).  subject n_i rows values. w.function sum(n_i) vector possible values include \"mean\" \"intercept\" \"slope\" \"bivar.\"  one unique value per subject","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC.Score2.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the gradient of the conditional likelihood for the univariate and bivariate sampling cases across all subjects (CheeseCalc=FALSE) or the cheese part of the sandwich estimator if CheeseCalc=TRUE. ‚Äî LogLikeC.Score2","title":"Calculate the gradient of the conditional likelihood for the univariate and bivariate sampling cases across all subjects (CheeseCalc=FALSE) or the cheese part of the sandwich estimator if CheeseCalc=TRUE. ‚Äî LogLikeC.Score2","text":"Calculate gradient conditional likelihood univariate bivariate sampling cases across subjects (CheeseCalc=FALSE) cheese part sandwich estimator CheeseCalc=TRUE.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC.Score2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the gradient of the conditional likelihood for the univariate and bivariate sampling cases across all subjects (CheeseCalc=FALSE) or the cheese part of the sandwich estimator if CheeseCalc=TRUE. ‚Äî LogLikeC.Score2","text":"","code":"LogLikeC.Score2(   y,   x,   z,   w.function,   id,   beta,   sigma.vc,   rho.vc,   sigma.e,   cutpoints,   SampProb,   Weights,   CheeseCalc = FALSE )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC.Score2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the gradient of the conditional likelihood for the univariate and bivariate sampling cases across all subjects (CheeseCalc=FALSE) or the cheese part of the sandwich estimator if CheeseCalc=TRUE. ‚Äî LogLikeC.Score2","text":"y response vector x sum(n_i) p design matrix fixed effects z sum(n_i) 2 design matric random effects (intercept slope) w.function sum(n_i) vector possible values include \"mean\" (mean response series), \"intercept\" (intercept regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[1,]), \"intercept1\"  (intercept regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[1,]). \"intercept2\" (second intercept regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[3,]), \"slope\" (slope regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[2,]), \"slope1\" (slope regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[2,]), \"slope2\" (second slope regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[4,]) \"bivar\" (intercept slope regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[c(1,2),]) \"mvints\" (first second intercepts bivariate regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[c(1,3),]) \"mvslps\" (first second slopes bivariate regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[c(1,3),]).  one unique value per subject id sum(n_i) vector subject ids beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution cutpoints matrix first dimension equal sum(n_i).  cutpoints define sampling regions (bivariate Q_i: row vector length 4 c(xlow, xhigh, ylow, yhigh); univariate Q_i: row vector length 2 c(k1,k2) define sampling regions, .e., low, middle, high).  subject n_i rows values. SampProb matrix first dimension equal sum(n_i).   Sampling probabilities within region (bivariate Q_i: row vector length 2 c(central region, outlying region); univariate Q_i: row vector length 3 sampling probabilities region). subject n_i rows values. Weights Subject specific sampling weights.  vector length sum(n_i).  used unless using weighted Likelihood CheeseCalc FALSE, function returns gradient conditional log likelihood across subjects.  TRUE, cheese part sandwich esitmator calculated.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC.Score2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the gradient of the conditional likelihood for the univariate and bivariate sampling cases across all subjects (CheeseCalc=FALSE) or the cheese part of the sandwich estimator if CheeseCalc=TRUE. ‚Äî LogLikeC.Score2","text":"CheeseCalc=FALSE, gradient conditional log likelihood.  CheeseCalc=TRUE, cheese part sandwich estimator calculated.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC2.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the conditional likelihood for the univariate and bivariate sampling cases across all subjects (Keep.liC=FALSE) or the subject specific contributions to the conditional likelihood along with the log-transformed ascertainment correction for multiple imputation (Keep.liC=TRUE). ‚Äî LogLikeC2","title":"Calculate the conditional likelihood for the univariate and bivariate sampling cases across all subjects (Keep.liC=FALSE) or the subject specific contributions to the conditional likelihood along with the log-transformed ascertainment correction for multiple imputation (Keep.liC=TRUE). ‚Äî LogLikeC2","text":"Calculate conditional likelihood univariate bivariate sampling cases across subjects (Keep.liC=FALSE) subject specific contributions conditional likelihood along log-transformed ascertainment correction multiple imputation (Keep.liC=TRUE).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the conditional likelihood for the univariate and bivariate sampling cases across all subjects (Keep.liC=FALSE) or the subject specific contributions to the conditional likelihood along with the log-transformed ascertainment correction for multiple imputation (Keep.liC=TRUE). ‚Äî LogLikeC2","text":"","code":"LogLikeC2(   y,   x,   z,   w.function,   id,   beta,   sigma.vc,   rho.vc,   sigma.e,   cutpoints,   SampProb,   Weights,   Keep.liC = FALSE )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the conditional likelihood for the univariate and bivariate sampling cases across all subjects (Keep.liC=FALSE) or the subject specific contributions to the conditional likelihood along with the log-transformed ascertainment correction for multiple imputation (Keep.liC=TRUE). ‚Äî LogLikeC2","text":"y response vector x sum(n_i) p design matrix fixed effects z sum(n_i) q design matrix random effects w.function sum(n_i) vector possible values include \"mean\" \"intercept\" \"slope\" \"bivar.\"  one unique value per subject id sum(n_i) vector subject ids beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution cutpoints matrix first dimension equal sum(n_i).  cutpoints define sampling regions (bivariate Q_i: row vector length 4 c(xlow, xhigh, ylow, yhigh); univariate Q_i: row vector length 2 c(k1,k2) define sampling regions, .e., low, middle, high).  subject n_i rows values. SampProb matrix first dimension equal sum(n_i).   Sampling probabilities within region (bivariate Q_i: row vector length 2 c(central region, outlying region); univariate Q_i: row vector length 3 sampling probabilities region). subject n_i rows values. Weights Subject specific sampling weights.  vector length sum(n_i).  used unless using weighted Likelihood Keep.liC FALSE, function returns conditional log likelihood across subjects.  TRUE, subject specific contributions exponentiated subject specific ascertainment corrections returned list.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeC2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the conditional likelihood for the univariate and bivariate sampling cases across all subjects (Keep.liC=FALSE) or the subject specific contributions to the conditional likelihood along with the log-transformed ascertainment correction for multiple imputation (Keep.liC=TRUE). ‚Äî LogLikeC2","text":"Keep.liC=FALSE, conditional log likelihood.  Keep.liC=TRUE, two-element list contains subject specific likelihood contributions exponentiated ascertainment corrections.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeCAndScore2.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the ascertainment corrected log likelihood and score ‚Äî LogLikeCAndScore2","title":"Calculate the ascertainment corrected log likelihood and score ‚Äî LogLikeCAndScore2","text":"Calculate ascertainment corrected log likelihood score","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeCAndScore2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the ascertainment corrected log likelihood and score ‚Äî LogLikeCAndScore2","text":"","code":"LogLikeCAndScore2(   params,   y,   x,   z,   id,   w.function,   cutpoints,   SampProb,   Weights,   ProfileCol = NA,   Keep.liC = FALSE )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeCAndScore2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the ascertainment corrected log likelihood and score ‚Äî LogLikeCAndScore2","text":"params parameter vector c(beta, log(sigma0), log(sigma1), rho, sigmae) y response vector x sum(n_i) p design matrix fixed effects z sum(n_i) 2 design matric random effects (intercept slope) id sum(n_i) vector subject ids w.function sum(n_i) vector possible values include \"mean\" (mean response series), \"intercept\" (intercept regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[1,]), \"intercept1\"  (intercept regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[1,]). \"intercept2\" (second intercept regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[3,]), \"slope\" (slope regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[2,]), \"slope1\" (slope regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[2,]), \"slope2\" (second slope regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[4,]) \"bivar\" (intercept slope regression Yi ~ zi zi design matrix random effects (solve(t.zi %% zi) %% t.zi)[c(1,2),]) \"mvints\" (first second intercepts bivariate regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[c(1,3),]) \"mvslps\" (first second slopes bivariate regression Yi ~ zi zi design matrix bivariate random effects (b10,b11,b20,b21) solve(t.zi %% zi) %% t.zi)[c(1,3),]).  one unique value per subject cutpoints matrix first dimension equal sum(n_i).  cutpoints define sampling regions (bivariate Q_i: row vector length 4 c(xlow, xhigh, ylow, yhigh); univariate Q_i: row vector length 2 c(k1,k2) define sampling regions, .e., low, middle, high).  subject n_i rows values. SampProb matrix first dimension equal sum(n_i).   Sampling probabilities within region (bivariate Q_i: row vector length 2 c(central region, outlying region); univariate Q_i: row vector length 3 sampling probabilities region). subject n_i rows values. Weights Subject specific sampling weights.  vector length sum(n_i).  used unless using weighted Likelihood ProfileCol column number(s) want fixed value param.  Maimizing log likelihood parameters fixing columns values params[ProfileCol] Keep.liC TRUE outputs subject specific conditional log lileihoods used imputation procedure described AOAS paper keep z sum(n_i) 2 design matric random effects (intercept slope)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeCAndScore2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the ascertainment corrected log likelihood and score ‚Äî LogLikeCAndScore2","text":"conditional log likelihood \"gradient\" attribute (Keep.liC=FALSE) subject specific contributions conditional likelihood Keep.liC=TRUE).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeiC2.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the ss contributions to the conditional likelihood for the univariate and bivariate sampling cases. ‚Äî LogLikeiC2","title":"Calculate the ss contributions to the conditional likelihood for the univariate and bivariate sampling cases. ‚Äî LogLikeiC2","text":"Calculate ss contributions conditional likelihood univariate bivariate sampling cases.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeiC2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the ss contributions to the conditional likelihood for the univariate and bivariate sampling cases. ‚Äî LogLikeiC2","text":"","code":"LogLikeiC2(subjectData, beta, sigma.vc, rho.vc, sigma.e)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeiC2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the ss contributions to the conditional likelihood for the univariate and bivariate sampling cases. ‚Äî LogLikeiC2","text":"subjectData list containing: yi, xi, zi, Weights., w.function., SampProb., cutpoints.beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/LogLikeiC2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the ss contributions to the conditional likelihood for the univariate and bivariate sampling cases. ‚Äî LogLikeiC2","text":"ss contributions conditional log likelihood.  internal function used LogLikeC2","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/acml.lmem2.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope) ‚Äî acml.lmem2","title":"Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope) ‚Äî acml.lmem2","text":"Fitting function: ACML WL linear mixed effects model (random intercept slope)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/acml.lmem2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope) ‚Äî acml.lmem2","text":"","code":"acml.lmem2(   formula.fixed,   formula.random,   data,   id,   w.function = \"mean\",   InitVals,   cutpoints,   SampProb,   Weights,   ProfileCol = NA )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/acml.lmem2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope) ‚Äî acml.lmem2","text":"formula.fixed formula fixed effects (form y~x) formula.random formula random effects (form ~z).  Right now model fits random intercept slope models. data data frame contain everything formula.fixed, formula.random, id, Weights.  include: w.function, cutpoints, SampProb id sum(n_i) vector subject ids (variable contained data) w.function sum(n_i) vector possible values include \"mean\" (mean response series), \"intercept\" (intercept regression Yi ~ zi zi design matrix random effects (solve(t.zi* zi) * t.zi)[1,]), \"intercept1\"  (intercept regression Yi ~ zi zi design matrix random effects (solve(t.zi * zi) * t.zi)[1,]). \"intercept2\" (second intercept regression Yi ~ InitVals starting values c(beta, log(sigma0), log(sigma1), log((1+rho)/(1-rho)), log(sigmae)) cutpoints matrix first dimension equal sum(n_i).  cutpoints define sampling regions individual subjects.  using low, medium, high, sampling scheme, sum(n_i) 2 matrix must distinct object contained dat dataframe.  row vector length 2 c(k1,k2) define sampling regions, .e., low, middle, high.  using square doughnut design sum(n_i) 4 matrix (var1lower, var1upper, var2lower, var2upper). subject n_i rows values. SampProb matrix first dimension equal sum(n_i).   Sampling probabilities within region. low medium high sampling, row vector length 3 sampling probabilities region. bivariate stratum sampling row vector length 2 sampling probabilities inner outer strata. subject n_i rows values.  data. Weights Subject specific sampling weights.  vector length sum(n_i).  variable data dataframe. used IPWL.  Note IPWL, use robcov (robust variances) covar.  IPWL, must vectors 1s. ProfileCol column number(s) want fixed value param.  Maximizing log likelihood parameters fixing columns values InitVals[ProfileCol]","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/acml.lmem2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope) ‚Äî acml.lmem2","text":"Ascertainment corrected Maximum likelihood: Ests, covar, LogL, code, robcov","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/bayes2stage-package.html","id":null,"dir":"Reference","previous_headings":"","what":"bayes2stage: Bayesian Analysis of Two-Stage Designs with Longitudinal Data ‚Äî bayes2stage-package","title":"bayes2stage: Bayesian Analysis of Two-Stage Designs with Longitudinal Data ‚Äî bayes2stage-package","text":"Tools designing analyzing two-stage studies longitudinal data. Supports outcome-dependent sampling (ODS) BLUP-dependent sampling (BDS) designs expensive covariates measured subset subjects. Bayesian model fitting uses 'Stan' via 'instantiate' package mixed effects models imputation. Also provides ascertainment-corrected maximum likelihood (ACML) estimation legacy support 'NIMBLE'-based fitting.","code":""},{"path":[]},{"path":"https://maxdrohde.github.io/bayes2stage/reference/bayes2stage-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"bayes2stage: Bayesian Analysis of Two-Stage Designs with Longitudinal Data ‚Äî bayes2stage-package","text":"Maintainer: Maximilian Rohde maxdrohde@gmail.com (ORCID)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/bds_design.html","id":null,"dir":"Reference","previous_headings":"","what":"Set x to missing based on an BDS design ‚Äî bds_design","title":"Set x to missing based on an BDS design ‚Äî bds_design","text":"Set x missing based BDS design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/bds_design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set x to missing based on an BDS design ‚Äî bds_design","text":"","code":"bds_design(   data,   fixed_effects_formula,   sampling_type,   cutoff_high,   cutoff_low,   n_sampled,   prop_high,   prop_middle,   prop_low )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/bds_design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set x to missing based on an BDS design ‚Äî bds_design","text":"data Dataset use fixed_effects_formula Formula fixed-effects fitting model estimate BLUPs sampling_type type sampling? \"intercept\" \"slope\" cutoff_high quantile use cutoff High category cutoff_low quantile use cutoff Low category n_sampled many subjects sampled? prop_high proportion sample High category? prop_middle proportion sample Middle category? prop_low proportion sample Low category?","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/bds_design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set x to missing based on an BDS design ‚Äî bds_design","text":"dataset x values selected based BDS design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/cantor_seed.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a unique seed from two indices using Cantor pairing ‚Äî cantor_seed","title":"Generate a unique seed from two indices using Cantor pairing ‚Äî cantor_seed","text":"Uses Cantor pairing function generate unique integer seed two positive integer indices. Useful reproducible simulations (, j) combination needs unique seed.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/cantor_seed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a unique seed from two indices using Cantor pairing ‚Äî cantor_seed","text":"","code":"cantor_seed(i, j)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/cantor_seed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a unique seed from two indices using Cantor pairing ‚Äî cantor_seed","text":"First positive integer index j Second positive integer index","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/cantor_seed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a unique seed from two indices using Cantor pairing ‚Äî cantor_seed","text":"unique integer seed","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/cantor_seed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a unique seed from two indices using Cantor pairing ‚Äî cantor_seed","text":"","code":"cantor_seed(1, 1) #> [1] 4 cantor_seed(5, 10) #> [1] 130"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/check_cols.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for required columns in a data frame ‚Äî check_cols","title":"Check for required columns in a data frame ‚Äî check_cols","text":"Validates data frame contains required columns.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/check_cols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for required columns in a data frame ‚Äî check_cols","text":"","code":"check_cols(data, required_cols)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/check_cols.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for required columns in a data frame ‚Äî check_cols","text":"data data frame check required_cols character vector required column names","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/check_cols.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for required columns in a data frame ‚Äî check_cols","text":"Invisibly returns TRUE columns present; otherwise throws error","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_acml_ods.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit ACML model for outcome-dependent sampling ‚Äî fit_acml_ods","title":"Fit ACML model for outcome-dependent sampling ‚Äî fit_acml_ods","text":"Fits ascertainment-corrected maximum likelihood model ODS designs.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_acml_ods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit ACML model for outcome-dependent sampling ‚Äî fit_acml_ods","text":"","code":"fit_acml_ods(ods_df, cutoff_low, cutoff_high)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_acml_ods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit ACML model for outcome-dependent sampling ‚Äî fit_acml_ods","text":"ods_df Data frame ODS sampling cutoff_low Lower cutoff value sampling regions cutoff_high Upper cutoff value sampling regions","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_acml_ods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit ACML model for outcome-dependent sampling ‚Äî fit_acml_ods","text":"data frame parameter estimates confidence intervals","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a Bayesian two-stage model using NIMBLE ‚Äî fit_model","title":"Fit a Bayesian two-stage model using NIMBLE ‚Äî fit_model","text":"Fits mixed effects model imputation using NIMBLE MCMC sampling.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a Bayesian two-stage model using NIMBLE ‚Äî fit_model","text":"","code":"fit_model(   data,   main_model_covariates,   imputation_model_covariates,   imputation_model_distribution,   correlated_random_effects = TRUE,   n_chains = 4,   niter = 10000,   nburnin = 2000,   x_size = NULL,   print_summary = FALSE,   print_code = FALSE )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a Bayesian two-stage model using NIMBLE ‚Äî fit_model","text":"data data frame containing outcome covariates. Must include columns: y (outcome), t (time), x (exposure), id (subject identifier). main_model_covariates Character vector covariate names main model imputation_model_covariates Character vector covariate names imputation model imputation_model_distribution Distribution imputation model. One : \"normal\", \"binomial\", \"beta_binomial\", \"poisson\", \"negative_binomial\" correlated_random_effects Logical; TRUE, random intercepts slopes correlated (default: TRUE) n_chains Number MCMC chains (default: 4) niter Number MCMC iterations per chain (default: 10000) nburnin Number burn-iterations discard (default: 2000) x_size Integer vector trial sizes; required binomial beta_binomial distributions (default: NULL) print_summary Logical; TRUE, prints MCMC summary (default: FALSE) print_code Logical; TRUE, prints NIMBLE model code (default: FALSE)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a Bayesian two-stage model using NIMBLE ‚Äî fit_model","text":"list containing MCMC samples optionally WAIC","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_stan_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a Bayesian two-stage model using Stan ‚Äî fit_stan_model","title":"Fit a Bayesian two-stage model using Stan ‚Äî fit_stan_model","text":"Fits mixed effects model imputation using Stan via instantiate package.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_stan_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a Bayesian two-stage model using Stan ‚Äî fit_stan_model","text":"","code":"fit_stan_model(   data,   main_model_covariates,   imputation_model_covariates,   imputation_distribution = c(\"normal\", \"bernoulli\", \"beta_binomial\",     \"negative_binomial\"),   n_chains = 4,   iter_warmup = 1000,   iter_sampling = 1000,   adapt_delta = 0.8,   seed = 777L,   parallel_chains = 1L )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_stan_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a Bayesian two-stage model using Stan ‚Äî fit_stan_model","text":"data data frame containing outcome covariates main_model_covariates Character vector covariate names main model imputation_model_covariates Character vector covariate names imputation model imputation_distribution Distribution imputation model: \"normal\" continuous x, \"bernoulli\" binary x, \"beta_binomial\" bounded count data, \"negative_binomial\" unbounded count data (default: \"normal\") n_chains Number MCMC chains (default: 4) iter_warmup Number warmup iterations per chain (default: 1000) iter_sampling Number sampling iterations per chain (default: 1000) adapt_delta Target acceptance rate HMC (default: 0.8) seed Random seed reproducibility (default: 777L) parallel_chains Number chains run parallel (default: 1L)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/fit_stan_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a Bayesian two-stage model using Stan ‚Äî fit_stan_model","text":"CmdStanMCMC fit object","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/format_data_mcmc.html","id":null,"dir":"Reference","previous_headings":"","what":"Format the simulated data for Stan / NIMBLE ‚Äî format_data_mcmc","title":"Format the simulated data for Stan / NIMBLE ‚Äî format_data_mcmc","text":"Format simulated data Stan / NIMBLE","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/format_data_mcmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format the simulated data for Stan / NIMBLE ‚Äî format_data_mcmc","text":"","code":"format_data_mcmc(   data,   main_model_covariates = NULL,   imputation_model_covariates = NULL,   imputation_distribution = c(\"normal\", \"bernoulli\", \"beta_binomial\",     \"negative_binomial\") )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/format_data_mcmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format the simulated data for Stan / NIMBLE ‚Äî format_data_mcmc","text":"data Dataset use main_model_covariates Character vector column names covariates main model imputation_model_covariates Character vector column names covariates imputation model imputation_distribution Distribution imputation model: \"normal\" continuous x, \"bernoulli\" binary x, \"beta_binomial\" bounded count data, \"negative_binomial\" unbounded count data","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/format_data_mcmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format the simulated data for Stan / NIMBLE ‚Äî format_data_mcmc","text":"list suitable input MCMC software","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate correlated random intercept / slope longitudinal data ‚Äî generate_data","title":"Generate correlated random intercept / slope longitudinal data ‚Äî generate_data","text":"Generates simulated longitudinal data correlated random intercepts slopes testing two-stage design methods.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate correlated random intercept / slope longitudinal data ‚Äî generate_data","text":"","code":"generate_data(   N = 2000,   M = 5,   alpha_main = 1,   beta_x = 1,   beta_z = 1,   beta_t = 2,   beta_t_x_interaction = 0.3,   beta_t_z_interaction = 0,   error_sd = 4,   x_dist = c(\"normal\", \"poisson\", \"binomial\", \"negative_binomial\", \"beta_binomial\"),   x_size = NULL,   x_disp_param = NULL,   rand_intercept_sd = 3,   rand_slope_sd = 1,   rand_eff_corr = 0,   gamma0 = 1,   gamma1 = 1,   gamma2 = 0,   gamma_sd = 2 )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate correlated random intercept / slope longitudinal data ‚Äî generate_data","text":"N Number subjects (default: 2000) M Number time points per subject (default: 5) alpha_main Intercept main model (default: 1) beta_x Coefficient x main model (default: 1) beta_z Coefficient z main model (default: 1) beta_t Coefficient time main model (default: 2) beta_t_x_interaction Coefficient time-x interaction (default: 0.3) beta_t_z_interaction Coefficient time-z interaction (default: 0) error_sd Standard deviation residual error (default: 4) x_dist Distribution x: \"normal\", \"poisson\", \"binomial\", \"negative_binomial\", \"beta_binomial\" (default: \"normal\") x_size Size parameter binomial/beta_binomial distributions x_disp_param Dispersion parameter negative_binomial/beta_binomial rand_intercept_sd Standard deviation random intercepts (default: 3) rand_slope_sd Standard deviation random slopes (default: 1) rand_eff_corr Correlation random intercepts slopes (default: 0) gamma0 Intercept imputation model (default: 1) gamma1 Linear coefficient z imputation model (default: 1) gamma2 Quadratic coefficient z imputation model (default: 0) gamma_sd Standard deviation imputation model (normal distribution ) (default: 2)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate correlated random intercept / slope longitudinal data ‚Äî generate_data","text":"data frame simulated longitudinal data","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data_schild_2019_supp.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate correlated random intercept / slope longitudinal data to test two-stage design methods. In the form of Schildcrout (2019) supplement ‚Äî generate_data_schild_2019_supp","title":"Generate correlated random intercept / slope longitudinal data to test two-stage design methods. In the form of Schildcrout (2019) supplement ‚Äî generate_data_schild_2019_supp","text":"Generate correlated random intercept / slope longitudinal data test two-stage design methods. form Schildcrout (2019) supplement","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data_schild_2019_supp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate correlated random intercept / slope longitudinal data to test two-stage design methods. In the form of Schildcrout (2019) supplement ‚Äî generate_data_schild_2019_supp","text":"","code":"generate_data_schild_2019_supp(   N,   Ms,   alpha_main,   beta_x,   beta_z,   beta_t,   beta_t_x_interaction,   beta_t_z_interaction,   error_sd,   x_prevalence,   rand_intercept_sd,   rand_slope_sd,   rand_eff_corr,   gamma0,   gamma1,   gamma2,   gamma_sd )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data_schild_2019_supp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate correlated random intercept / slope longitudinal data to test two-stage design methods. In the form of Schildcrout (2019) supplement ‚Äî generate_data_schild_2019_supp","text":"N Integer. Total number subjects cohort. Default 2000. Ms Integer vector. Possible numbers observations per subject, sampled uniformly. Default c(4, 5, 6). alpha_main Numeric. Fixed intercept (Œ≤‚ÇÄ). Default 75. beta_x Numeric. Main effect binary exposure X (Œ≤_s). Default -0.5. beta_z Numeric. Effect continuous confounder Z (Œ≤_c). Default -2. beta_t Numeric. Fixed time effect (Œ≤_t). Default -1. beta_t_x_interaction Numeric. Interaction time exposure (Œ≤_st). Default -0.5. beta_t_z_interaction Numeric. Interaction time confounder. Default 0. error_sd Numeric. Standard deviation measurement error (œÉ_e). Default sqrt(12.25) = 3.5. x_prevalence Numeric. Prevalence binary exposure X. Must 0 1. Default 0.25. rand_intercept_sd Numeric. Standard deviation random intercept (œÉ‚ÇÄ). Default sqrt(81) = 9. rand_slope_sd Numeric. Standard deviation random slope (œÉ‚ÇÅ). Default sqrt(1.56) = 1.25. rand_eff_corr Numeric. Correlation random intercept slope (œÅ). Must -1 1. Default 0. gamma0 Numeric. Intercept confounder Z generation. Default 0.25. gamma1 Numeric. Linear coefficient X Z generation. Default 0.5. gamma2 Numeric. Quadratic coefficient X Z generation. Default 0. gamma_sd Numeric. Standard deviation Z residual error. Default 1.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/generate_data_schild_2019_supp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate correlated random intercept / slope longitudinal data to test two-stage design methods. In the form of Schildcrout (2019) supplement ‚Äî generate_data_schild_2019_supp","text":"dataset","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a subject-specific contribution to a log-likelihood for longitudinal normal data ‚Äî li.lme","title":"Calculate a subject-specific contribution to a log-likelihood for longitudinal normal data ‚Äî li.lme","text":"Calculate subject-specific contribution log-likelihood longitudinal normal data","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a subject-specific contribution to a log-likelihood for longitudinal normal data ‚Äî li.lme","text":"","code":"li.lme(yi, xi, beta, vi)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a subject-specific contribution to a log-likelihood for longitudinal normal data ‚Äî li.lme","text":"yi n_i-response vector xi n_i p design matrix fixed effects beta mean model parameter vector vi variance covariance matrix (ZDZ+Sige2*)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a subject-specific contribution to a log-likelihood for longitudinal normal data ‚Äî li.lme","text":"subject specific contribution log-likelihood","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.score2.html","id":null,"dir":"Reference","previous_headings":"","what":"Subject specific contribution to the lme model score (also returns marginal Vi=Cov(Y|X)) ‚Äî li.lme.score2","title":"Subject specific contribution to the lme model score (also returns marginal Vi=Cov(Y|X)) ‚Äî li.lme.score2","text":"Subject specific contribution lme model score (also returns marginal Vi=Cov(Y|X))","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.score2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subject specific contribution to the lme model score (also returns marginal Vi=Cov(Y|X)) ‚Äî li.lme.score2","text":"","code":"li.lme.score2(subjectData, beta, sigma.vc, rho.vc, sigma.e)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.score2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subject specific contribution to the lme model score (also returns marginal Vi=Cov(Y|X)) ‚Äî li.lme.score2","text":"subjectData list contains yi, xi, zi, Weights..  Note Weights.used inverse probability weighting . beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/li.lme.score2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subject specific contribution to the lme model score (also returns marginal Vi=Cov(Y|X)) ‚Äî li.lme.score2","text":"Subject specific contribution log-likelihood score (also returns marginal Vi=Cov(Y|X))","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.html","id":null,"dir":"Reference","previous_headings":"","what":"Log of the Ascertainment correction for univariate sampling ‚Äî logACi1q","title":"Log of the Ascertainment correction for univariate sampling ‚Äî logACi1q","text":"Calculate log transformed ascertainment correction univariate Q_i.  Also return vi","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log of the Ascertainment correction for univariate sampling ‚Äî logACi1q","text":"","code":"logACi1q(yi, xi, zi, wi, beta, sigma.vc, rho.vc, sigma.e, cutpoints, SampProb)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log of the Ascertainment correction for univariate sampling ‚Äî logACi1q","text":"yi n_i-response vector xi n_i p design matrix fixed effects zi n_i q design matric random effects (intercept slope) wi pre-multiplier yi generate sampling variable q_i beta mean model parameter vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution cutpoints cutpoints defining sampling regions. (vector length 2) SampProb Sampling probabilities within region (vector length 3).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log of the Ascertainment correction for univariate sampling ‚Äî logACi1q","text":"log transformed ascertainment correction","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.score2.html","id":null,"dir":"Reference","previous_headings":"","what":"Gradient of the log of the ascertainment correction piece for sampling based on univariate Q_i ‚Äî logACi1q.score2","title":"Gradient of the log of the ascertainment correction piece for sampling based on univariate Q_i ‚Äî logACi1q.score2","text":"Calculate gradient log transformed ascertainment correction sampling based univariate Q_i","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.score2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gradient of the log of the ascertainment correction piece for sampling based on univariate Q_i ‚Äî logACi1q.score2","text":"","code":"logACi1q.score2(subjectData, beta, sigma.vc, rho.vc, sigma.e)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.score2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gradient of the log of the ascertainment correction piece for sampling based on univariate Q_i ‚Äî logACi1q.score2","text":"subjectData list containing: yi, xi, zi, Weights., w.function., SampProb., cutpoints.beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi1q.score2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gradient of the log of the ascertainment correction piece for sampling based on univariate Q_i ‚Äî logACi1q.score2","text":"gradient log transformed ascertainment correction univariate $Q_i$","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.html","id":null,"dir":"Reference","previous_headings":"","what":"Log of the Ascertainment correction piece for bivariate sampling ‚Äî logACi2q","title":"Log of the Ascertainment correction piece for bivariate sampling ‚Äî logACi2q","text":"Calculate log transformed ascertainment correction bivariate Q_i.  Also return vi","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log of the Ascertainment correction piece for bivariate sampling ‚Äî logACi2q","text":"","code":"logACi2q(yi, xi, zi, wi, beta, sigma.vc, rho.vc, sigma.e, cutpoints, SampProb)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log of the Ascertainment correction piece for bivariate sampling ‚Äî logACi2q","text":"yi n_i-response vector xi n_i p design matrix fixed effects zi n_i q design matric random effects (intercept slope) wi pre-multiplier yi generate sampling variable q_i beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution cutpoints cutpoints defining sampling regions. (vector length 4 c(xlow, xhigh, ylow, yhigh)) SampProb Sampling probabilities within region (vector length 2 c(central region, outlying region)).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log of the Ascertainment correction piece for bivariate sampling ‚Äî logACi2q","text":"log transformed ascertainment correction","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.score2.html","id":null,"dir":"Reference","previous_headings":"","what":"Gradient of the log of the ascertainment correction piece for sampling based on bivariate Q_i. ‚Äî logACi2q.score2","title":"Gradient of the log of the ascertainment correction piece for sampling based on bivariate Q_i. ‚Äî logACi2q.score2","text":"Calculate gradient log transformed ascertainment correction designs sample based bivariate Q_i (numerically).","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.score2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gradient of the log of the ascertainment correction piece for sampling based on bivariate Q_i. ‚Äî logACi2q.score2","text":"","code":"logACi2q.score2(subjectData, beta, sigma.vc, rho.vc, sigma.e)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.score2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gradient of the log of the ascertainment correction piece for sampling based on bivariate Q_i. ‚Äî logACi2q.score2","text":"subjectData list containing: yi, xi, zi, Weights., w.function, SampProb, cutpoints beta mean model parameter p-vector sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/logACi2q.score2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gradient of the log of the ascertainment correction piece for sampling based on bivariate Q_i. ‚Äî logACi2q.score2","text":"gradient log transformed ascertainment correction bivariate sampling design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_forest.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a forest plot of MCMC output ‚Äî mcmc_forest","title":"Create a forest plot of MCMC output ‚Äî mcmc_forest","text":"wrapper around MCMCvis::MCMCplot create forest plots MCMC samples.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_forest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a forest plot of MCMC output ‚Äî mcmc_forest","text":"","code":"mcmc_forest(mcmc_output)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_forest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a forest plot of MCMC output ‚Äî mcmc_forest","text":"mcmc_output MCMC output object (e.g., fit_model)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_forest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a forest plot of MCMC output ‚Äî mcmc_forest","text":"forest plot parameter estimates","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract MCMC summary statistics ‚Äî mcmc_summary","title":"Extract MCMC summary statistics ‚Äî mcmc_summary","text":"wrapper around MCMCvis::MCMCsummary extract summary statistics MCMC samples.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract MCMC summary statistics ‚Äî mcmc_summary","text":"","code":"mcmc_summary(mcmc_output, dataset_id)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract MCMC summary statistics ‚Äî mcmc_summary","text":"mcmc_output MCMC output object (e.g., fit_model) dataset_id character string identifying dataset (added column)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract MCMC summary statistics ‚Äî mcmc_summary","text":"data frame summary statistics parameter","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_trace.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot MCMC trace plots ‚Äî mcmc_trace","title":"Plot MCMC trace plots ‚Äî mcmc_trace","text":"wrapper around MCMCvis::MCMCtrace create trace plots MCMC samples.","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_trace.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot MCMC trace plots ‚Äî mcmc_trace","text":"","code":"mcmc_trace(mcmc_output, print_to_pdf = FALSE)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_trace.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot MCMC trace plots ‚Äî mcmc_trace","text":"mcmc_output MCMC output object (e.g., fit_model) print_to_pdf Logical; TRUE, saves trace plots PDF file","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/mcmc_trace.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot MCMC trace plots ‚Äî mcmc_trace","text":"Trace plots MCMC samples","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ods_design.html","id":null,"dir":"Reference","previous_headings":"","what":"Set x to missing based on an ODS design ‚Äî ods_design","title":"Set x to missing based on an ODS design ‚Äî ods_design","text":"Set x missing based ODS design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ods_design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set x to missing based on an ODS design ‚Äî ods_design","text":"","code":"ods_design(   data,   sampling_type,   cutoff_high,   cutoff_low,   n_sampled,   prop_high,   prop_middle,   prop_low )"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ods_design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set x to missing based on an ODS design ‚Äî ods_design","text":"data Dataset use sampling_type type sampling? \"intercept\" \"slope\" cutoff_high quantile use cutoff High category cutoff_low quantile use cutoff Low category n_sampled many subjects sampled? prop_high proportion sample High category? prop_middle proportion sample Middle category? prop_low proportion sample Low category?","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/ods_design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set x to missing based on an ODS design ‚Äî ods_design","text":"dataset x values selected based ODS design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/plot_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot simulated data ‚Äî plot_data","title":"Plot simulated data ‚Äî plot_data","text":"Plot simulated data","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/plot_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot simulated data ‚Äî plot_data","text":"","code":"plot_data(data, subset_size = 200)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/plot_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot simulated data ‚Äî plot_data","text":"data Dataset use subset_size many subjects use?","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/plot_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot simulated data ‚Äî plot_data","text":"ggplot2 object","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/set_missing.html","id":null,"dir":"Reference","previous_headings":"","what":"Given selected subjects, set X to missing for those not selected ‚Äî set_missing","title":"Given selected subjects, set X to missing for those not selected ‚Äî set_missing","text":"Given selected subjects, set X missing selected","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/set_missing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Given selected subjects, set X to missing for those not selected ‚Äî set_missing","text":"","code":"set_missing(data, selected_ids)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/set_missing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Given selected subjects, set X to missing for those not selected ‚Äî set_missing","text":"data Input data frame selected_ids IDs selected subjects","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/set_missing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Given selected subjects, set X to missing for those not selected ‚Äî set_missing","text":"data.frame","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/srs_design.html","id":null,"dir":"Reference","previous_headings":"","what":"Set x to missing based on an SRS design ‚Äî srs_design","title":"Set x to missing based on an SRS design ‚Äî srs_design","text":"Set x missing based SRS design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/srs_design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set x to missing based on an SRS design ‚Äî srs_design","text":"","code":"srs_design(data, n_sampled)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/srs_design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set x to missing based on an SRS design ‚Äî srs_design","text":"data Dataset use n_sampled many subjects sample?","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/srs_design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set x to missing based on an SRS design ‚Äî srs_design","text":"dataset x values selected based SRS design","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/vi.calc.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate V_i = Z_i D t(Z_i) + sig_e^2 I_(n_i) ‚Äî vi.calc","title":"Calculate V_i = Z_i D t(Z_i) + sig_e^2 I_(n_i) ‚Äî vi.calc","text":"Calculate V_i = Z_i D t(Z_i) + sig_e^2 I_(n_i)","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/vi.calc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate V_i = Z_i D t(Z_i) + sig_e^2 I_(n_i) ‚Äî vi.calc","text":"","code":"vi.calc(zi, sigma.vc, rho.vc, sigma.e)"},{"path":"https://maxdrohde.github.io/bayes2stage/reference/vi.calc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate V_i = Z_i D t(Z_i) + sig_e^2 I_(n_i) ‚Äî vi.calc","text":"zi n_i q design matrix random effects sigma.vc vector variance components standard deviation scale rho.vc vector correlations among random effects.  length q choose 2 sigma.e std dev measurement error distribution","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/reference/vi.calc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate V_i = Z_i D t(Z_i) + sig_e^2 I_(n_i) ‚Äî vi.calc","text":"V_i","code":""},{"path":"https://maxdrohde.github.io/bayes2stage/news/index.html","id":"bayes2stage-0009000","dir":"Changelog","previous_headings":"","what":"bayes2stage 0.0.0.9000","title":"bayes2stage 0.0.0.9000","text":"Stan-based model fitting via fit_stan_model() using ‚Äòinstantiate‚Äô package. Support four covariate distributions: normal, bernoulli, negative binomial, beta binomial. Three sampling design functions: srs_design(), ods_design(), bds_design(). Ascertainment-corrected maximum likelihood estimation via fit_acml_ods(). Data simulation generate_data() supporting multiple covariate distributions. Added package vignette complete workflow example. Legacy NIMBLE-based fitting available via fit_model().","code":""}]
