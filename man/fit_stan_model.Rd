% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_stan.R
\name{fit_stan_model}
\alias{fit_stan_model}
\title{Fit a Bayesian two-stage model using Stan}
\usage{
fit_stan_model(
  data,
  main_model_covariates,
  imputation_model_covariates,
  imputation_distribution = c("normal", "bernoulli", "beta_binomial",
    "negative_binomial"),
  parameterization = c("noncentered", "centered", "marginalized"),
  use_pathfinder_init = FALSE,
  pathfinder_num_paths = 4L,
  n_chains = 4L,
  iter_warmup = 1000L,
  iter_sampling = 1000L,
  adapt_delta = 0.8,
  seed = 777L,
  parallel_chains = 1L
)
}
\arguments{
\item{data}{A data frame containing the outcome and covariates}

\item{main_model_covariates}{Character vector of covariate names for the main model}

\item{imputation_model_covariates}{Character vector of covariate names for the imputation model}

\item{imputation_distribution}{Distribution for the imputation model:
"normal" for continuous x, "bernoulli" for binary x, "beta_binomial"
for bounded count data, or "negative_binomial" for unbounded count data
(default: "normal")}

\item{parameterization}{Parameterization for random effects:
\itemize{
\item "noncentered" (default): Works better with weakly informative data (small N)
\item "centered": Works better with highly informative data (large N)
\item "marginalized": Integrates out random effects and missing x analytically.
Eliminates funnel geometry but has O(G * n_g^3) likelihood cost per subject.
Best for datasets with sampling issues. Available for all distributions.
Note: Beta-binomial marginalized requires all subjects have the same n_trials.
}}

\item{use_pathfinder_init}{Logical; if TRUE, use Pathfinder variational inference
to initialize MCMC chains. This can dramatically improve sampling efficiency
for complex models with many latent parameters (default: FALSE)}

\item{pathfinder_num_paths}{Number of Pathfinder paths to run (default: 4, one per chain)}

\item{n_chains}{Number of MCMC chains (default: 4)}

\item{iter_warmup}{Number of warmup iterations per chain (default: 1000)}

\item{iter_sampling}{Number of sampling iterations per chain (default: 1000)}

\item{adapt_delta}{Target acceptance rate for HMC (default: 0.8)}

\item{seed}{Random seed for reproducibility (default: 777L)}

\item{parallel_chains}{Number of chains to run in parallel (default: 1L)}
}
\value{
A CmdStanMCMC fit object
}
\description{
Fits a mixed effects model with imputation using Stan via the instantiate package.
}
