
R version 4.4.2 (2024-10-31) -- "Pile of Leaves"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # This file is part of the standard setup for testthat.
> # It is recommended that you do not modify it.
> #
> # Where should you do additional test configuration?
> # Learn more about the roles of various files in:
> # * https://r-pkgs.org/testing-design.html#sec-tests-files-overview
> # * https://testthat.r-lib.org/articles/special-files.html
> 
> library(testthat)
> library(bayes2stage)
Loading required package: MASS
Loading required package: mvtnorm
Loading required package: nimble
nimble version 1.3.0 is loaded.
For more information on NIMBLE and a User Manual,
please visit https://R-nimble.org.

Note for advanced users who have written their own MCMC samplers:
  As of version 0.13.0, NIMBLE's protocol for handling posterior
  predictive nodes has changed in a way that could affect user-defined
  samplers in some situations. Please see Section 15.5.1 of the User Manual.

Attaching package: 'nimble'

The following object is masked from 'package:mvtnorm':

    logdet

The following object is masked from 'package:stats':

    simulate

The following object is masked from 'package:base':

    declare

Loading required package: nimbleEcology
Loading nimbleEcology. Registering multiple variants of the following distributions:
 dOcc, dDynOcc, dCJS, dHMM, dDHMM, dNmixture.

Loading required package: nimbleMacros
Loading required package: numDeriv
> 
> test_check("bayes2stage")
Defining model
  [Note] 'id_factor' is provided in 'constants' but not used in the model code and is being ignored.
  [Note] Processing model macro `LINPRED`.
  [Note] Processing model macro `FORLOOP`.
  [Note] Processing model macro `LINPRED_PRIORS`.
  [Note] Processing model macro `FORLOOP`.
  [Note] Processing model macro `LINPRED`.
  [Note] Processing model macro `FORLOOP`.
  [Note] Processing model macro `LINPRED_PRIORS`.
  [Note] Processing model macro `FORLOOP`.
  [Note] Using 'x,y' (given within 'constants') as data.
Building model
Setting data and initial values
Running calculate on model
  [Note] Any error reports that follow may simply reflect missing values in model variables.
Checking model sizes and dimensions
  [Note] This model is not fully initialized. This is not an error.
         To see which variables are not initialized, use model$initializeInfo().
         For more information on model initialization, see help(modelInitialization).
Compiling
  [Note] This may take a minute.
  [Note] Use 'showCompilerOutput = TRUE' to see C++ compilation details.
Compiling
  [Note] This may take a minute.
  [Note] Use 'showCompilerOutput = TRUE' to see C++ compilation details.
running chain 1...
|-------------|-------------|-------------|-------------|
|-------------------------------------------------------|
  [Warning] There are 39 individual pWAIC values that are greater than 0.4. This may indicate that the WAIC estimate is unstable (Vehtari et al., 2017), at least in cases without grouping of data nodes or multivariate data nodes.
CODE:----------------------------------------------------------------{
    "# LINPRED"
    "  ## nimbleMacros::FORLOOP"
    for (i_1 in 1:N) {
        mu[i_1] <- beta_Intercept + beta_x * x[id[i_1]] + beta_z * 
            z[id[i_1]] + beta_t * t[i_1] + beta_x_t * x[id[i_1]] * 
            t[i_1]
    }
    "  ## ----"
    "  ## nimbleMacros::LINPRED_PRIORS"
    beta_Intercept ~ dnorm(0, sd = 2)
    beta_x ~ dnorm(0, sd = 2)
    beta_z ~ dnorm(0, sd = 2)
    beta_t ~ dnorm(0, sd = 2)
    beta_x_t ~ dnorm(0, sd = 2)
    "  ## ----"
    "# ----"
    sigma_u0 ~ dexp(rate = 0.1)
    sigma_u1 ~ dexp(rate = 0.1)
    rho ~ dunif(-0.99, 0.99)
    for (j in 1:G) {
        u0_raw[j] ~ dnorm(0, sd = 1)
        u1_raw[j] ~ dnorm(0, sd = 1)
    }
    for (j in 1:G) {
        u0[j] <- sigma_u0 * u0_raw[j]
        u1[j] <- sigma_u1 * (rho * u0_raw[j] + sqrt(1 - rho^2) * 
            u1_raw[j])
    }
    for (i in 1:N) {
        mu_total[i] <- mu[i] + u0[id[i]] + u1[id[i]] * t[i]
    }
    "# FORLOOP"
    for (i_2 in 1:N) {
        y[i_2] ~ dnorm(mu_total[i_2], sd = sigma_residual)
    }
    "# ----"
    sigma_residual ~ dexp(rate = 0.1)
    "# LINPRED"
    "  ## nimbleMacros::FORLOOP"
    for (i_3 in 1:G) {
        eta[i_3] <- gamma_Intercept + gamma_z * z[i_3]
    }
    "  ## ----"
    "  ## nimbleMacros::LINPRED_PRIORS"
    gamma_Intercept ~ dnorm(0, sd = 2)
    gamma_z ~ dnorm(0, sd = 2)
    "  ## ----"
    "# ----"
    "# FORLOOP"
    for (i_4 in 1:G) {
        x[i_4] ~ dnorm(eta[i_4], sd = sigma_imputation)
    }
    "# ----"
    sigma_imputation ~ dexp(rate = 0.1)
}
---------------------------------------------------------------------[1]   conjugate_dnorm_dnorm_additive sampler: beta_Intercept
[2]   conjugate_dnorm_dnorm_linear sampler: beta_x
[3]   conjugate_dnorm_dnorm_linear sampler: beta_z
[4]   conjugate_dnorm_dnorm_linear sampler: beta_t
[5]   conjugate_dnorm_dnorm_linear sampler: beta_x_t
[6]   RW sampler: sigma_u0
[7]   RW sampler: sigma_u1
[8]   RW sampler: rho
[9]   conjugate_dnorm_dnorm_linear sampler: u0_raw[1]
[10]  conjugate_dnorm_dnorm_linear sampler: u0_raw[2]
[11]  conjugate_dnorm_dnorm_linear sampler: u0_raw[3]
[12]  conjugate_dnorm_dnorm_linear sampler: u0_raw[4]
[13]  conjugate_dnorm_dnorm_linear sampler: u0_raw[5]
[14]  conjugate_dnorm_dnorm_linear sampler: u0_raw[6]
[15]  conjugate_dnorm_dnorm_linear sampler: u0_raw[7]
[16]  conjugate_dnorm_dnorm_linear sampler: u0_raw[8]
[17]  conjugate_dnorm_dnorm_linear sampler: u0_raw[9]
[18]  conjugate_dnorm_dnorm_linear sampler: u0_raw[10]
[19]  conjugate_dnorm_dnorm_linear sampler: u0_raw[11]
[20]  conjugate_dnorm_dnorm_linear sampler: u0_raw[12]
[21]  conjugate_dnorm_dnorm_linear sampler: u0_raw[13]
[22]  conjugate_dnorm_dnorm_linear sampler: u0_raw[14]
[23]  conjugate_dnorm_dnorm_linear sampler: u0_raw[15]
[24]  conjugate_dnorm_dnorm_linear sampler: u0_raw[16]
[25]  conjugate_dnorm_dnorm_linear sampler: u0_raw[17]
[26]  conjugate_dnorm_dnorm_linear sampler: u0_raw[18]
[27]  conjugate_dnorm_dnorm_linear sampler: u0_raw[19]
[28]  conjugate_dnorm_dnorm_linear sampler: u0_raw[20]
[29]  conjugate_dnorm_dnorm_linear sampler: u0_raw[21]
[30]  conjugate_dnorm_dnorm_linear sampler: u0_raw[22]
[31]  conjugate_dnorm_dnorm_linear sampler: u0_raw[23]
[32]  conjugate_dnorm_dnorm_linear sampler: u0_raw[24]
[33]  conjugate_dnorm_dnorm_linear sampler: u0_raw[25]
[34]  conjugate_dnorm_dnorm_linear sampler: u0_raw[26]
[35]  conjugate_dnorm_dnorm_linear sampler: u0_raw[27]
[36]  conjugate_dnorm_dnorm_linear sampler: u0_raw[28]
[37]  conjugate_dnorm_dnorm_linear sampler: u0_raw[29]
[38]  conjugate_dnorm_dnorm_linear sampler: u0_raw[30]
[39]  conjugate_dnorm_dnorm_linear sampler: u0_raw[31]
[40]  conjugate_dnorm_dnorm_linear sampler: u0_raw[32]
[41]  conjugate_dnorm_dnorm_linear sampler: u0_raw[33]
[42]  conjugate_dnorm_dnorm_linear sampler: u0_raw[34]
[43]  conjugate_dnorm_dnorm_linear sampler: u0_raw[35]
[44]  conjugate_dnorm_dnorm_linear sampler: u0_raw[36]
[45]  conjugate_dnorm_dnorm_linear sampler: u0_raw[37]
[46]  conjugate_dnorm_dnorm_linear sampler: u0_raw[38]
[47]  conjugate_dnorm_dnorm_linear sampler: u0_raw[39]
[48]  conjugate_dnorm_dnorm_linear sampler: u0_raw[40]
[49]  conjugate_dnorm_dnorm_linear sampler: u0_raw[41]
[50]  conjugate_dnorm_dnorm_linear sampler: u0_raw[42]
[51]  conjugate_dnorm_dnorm_linear sampler: u0_raw[43]
[52]  conjugate_dnorm_dnorm_linear sampler: u0_raw[44]
[53]  conjugate_dnorm_dnorm_linear sampler: u0_raw[45]
[54]  conjugate_dnorm_dnorm_linear sampler: u0_raw[46]
[55]  conjugate_dnorm_dnorm_linear sampler: u0_raw[47]
[56]  conjugate_dnorm_dnorm_linear sampler: u0_raw[48]
[57]  conjugate_dnorm_dnorm_linear sampler: u0_raw[49]
[58]  conjugate_dnorm_dnorm_linear sampler: u0_raw[50]
[59]  conjugate_dnorm_dnorm_linear sampler: u0_raw[51]
[60]  conjugate_dnorm_dnorm_linear sampler: u0_raw[52]
[61]  conjugate_dnorm_dnorm_linear sampler: u0_raw[53]
[62]  conjugate_dnorm_dnorm_linear sampler: u0_raw[54]
[63]  conjugate_dnorm_dnorm_linear sampler: u0_raw[55]
[64]  conjugate_dnorm_dnorm_linear sampler: u0_raw[56]
[65]  conjugate_dnorm_dnorm_linear sampler: u0_raw[57]
[66]  conjugate_dnorm_dnorm_linear sampler: u0_raw[58]
[67]  conjugate_dnorm_dnorm_linear sampler: u0_raw[59]
[68]  conjugate_dnorm_dnorm_linear sampler: u0_raw[60]
[69]  conjugate_dnorm_dnorm_linear sampler: u0_raw[61]
[70]  conjugate_dnorm_dnorm_linear sampler: u0_raw[62]
[71]  conjugate_dnorm_dnorm_linear sampler: u0_raw[63]
[72]  conjugate_dnorm_dnorm_linear sampler: u0_raw[64]
[73]  conjugate_dnorm_dnorm_linear sampler: u0_raw[65]
[74]  conjugate_dnorm_dnorm_linear sampler: u0_raw[66]
[75]  conjugate_dnorm_dnorm_linear sampler: u0_raw[67]
[76]  conjugate_dnorm_dnorm_linear sampler: u0_raw[68]
[77]  conjugate_dnorm_dnorm_linear sampler: u0_raw[69]
[78]  conjugate_dnorm_dnorm_linear sampler: u0_raw[70]
[79]  conjugate_dnorm_dnorm_linear sampler: u0_raw[71]
[80]  conjugate_dnorm_dnorm_linear sampler: u0_raw[72]
[81]  conjugate_dnorm_dnorm_linear sampler: u0_raw[73]
[82]  conjugate_dnorm_dnorm_linear sampler: u0_raw[74]
[83]  conjugate_dnorm_dnorm_linear sampler: u0_raw[75]
[84]  conjugate_dnorm_dnorm_linear sampler: u0_raw[76]
[85]  conjugate_dnorm_dnorm_linear sampler: u0_raw[77]
[86]  conjugate_dnorm_dnorm_linear sampler: u0_raw[78]
[87]  conjugate_dnorm_dnorm_linear sampler: u0_raw[79]
[88]  conjugate_dnorm_dnorm_linear sampler: u0_raw[80]
[89]  conjugate_dnorm_dnorm_linear sampler: u0_raw[81]
[90]  conjugate_dnorm_dnorm_linear sampler: u0_raw[82]
[91]  conjugate_dnorm_dnorm_linear sampler: u0_raw[83]
[92]  conjugate_dnorm_dnorm_linear sampler: u0_raw[84]
[93]  conjugate_dnorm_dnorm_linear sampler: u0_raw[85]
[94]  conjugate_dnorm_dnorm_linear sampler: u0_raw[86]
[95]  conjugate_dnorm_dnorm_linear sampler: u0_raw[87]
[96]  conjugate_dnorm_dnorm_linear sampler: u0_raw[88]
[97]  conjugate_dnorm_dnorm_linear sampler: u0_raw[89]
[98]  conjugate_dnorm_dnorm_linear sampler: u0_raw[90]
[99]  conjugate_dnorm_dnorm_linear sampler: u0_raw[91]
[100] conjugate_dnorm_dnorm_linear sampler: u0_raw[92]
[101] conjugate_dnorm_dnorm_linear sampler: u0_raw[93]
[102] conjugate_dnorm_dnorm_linear sampler: u0_raw[94]
[103] conjugate_dnorm_dnorm_linear sampler: u0_raw[95]
[104] conjugate_dnorm_dnorm_linear sampler: u0_raw[96]
[105] conjugate_dnorm_dnorm_linear sampler: u0_raw[97]
[106] conjugate_dnorm_dnorm_linear sampler: u0_raw[98]
[107] conjugate_dnorm_dnorm_linear sampler: u0_raw[99]
[108] conjugate_dnorm_dnorm_linear sampler: u0_raw[100]
[109] conjugate_dnorm_dnorm_linear sampler: u1_raw[1]
[110] conjugate_dnorm_dnorm_linear sampler: u1_raw[2]
[111] conjugate_dnorm_dnorm_linear sampler: u1_raw[3]
[112] conjugate_dnorm_dnorm_linear sampler: u1_raw[4]
[113] conjugate_dnorm_dnorm_linear sampler: u1_raw[5]
[114] conjugate_dnorm_dnorm_linear sampler: u1_raw[6]
[115] conjugate_dnorm_dnorm_linear sampler: u1_raw[7]
[116] conjugate_dnorm_dnorm_linear sampler: u1_raw[8]
[117] conjugate_dnorm_dnorm_linear sampler: u1_raw[9]
[118] conjugate_dnorm_dnorm_linear sampler: u1_raw[10]
[119] conjugate_dnorm_dnorm_linear sampler: u1_raw[11]
[120] conjugate_dnorm_dnorm_linear sampler: u1_raw[12]
[121] conjugate_dnorm_dnorm_linear sampler: u1_raw[13]
[122] conjugate_dnorm_dnorm_linear sampler: u1_raw[14]
[123] conjugate_dnorm_dnorm_linear sampler: u1_raw[15]
[124] conjugate_dnorm_dnorm_linear sampler: u1_raw[16]
[125] conjugate_dnorm_dnorm_linear sampler: u1_raw[17]
[126] conjugate_dnorm_dnorm_linear sampler: u1_raw[18]
[127] conjugate_dnorm_dnorm_linear sampler: u1_raw[19]
[128] conjugate_dnorm_dnorm_linear sampler: u1_raw[20]
[129] conjugate_dnorm_dnorm_linear sampler: u1_raw[21]
[130] conjugate_dnorm_dnorm_linear sampler: u1_raw[22]
[131] conjugate_dnorm_dnorm_linear sampler: u1_raw[23]
[132] conjugate_dnorm_dnorm_linear sampler: u1_raw[24]
[133] conjugate_dnorm_dnorm_linear sampler: u1_raw[25]
[134] conjugate_dnorm_dnorm_linear sampler: u1_raw[26]
[135] conjugate_dnorm_dnorm_linear sampler: u1_raw[27]
[136] conjugate_dnorm_dnorm_linear sampler: u1_raw[28]
[137] conjugate_dnorm_dnorm_linear sampler: u1_raw[29]
[138] conjugate_dnorm_dnorm_linear sampler: u1_raw[30]
[139] conjugate_dnorm_dnorm_linear sampler: u1_raw[31]
[140] conjugate_dnorm_dnorm_linear sampler: u1_raw[32]
[141] conjugate_dnorm_dnorm_linear sampler: u1_raw[33]
[142] conjugate_dnorm_dnorm_linear sampler: u1_raw[34]
[143] conjugate_dnorm_dnorm_linear sampler: u1_raw[35]
[144] conjugate_dnorm_dnorm_linear sampler: u1_raw[36]
[145] conjugate_dnorm_dnorm_linear sampler: u1_raw[37]
[146] conjugate_dnorm_dnorm_linear sampler: u1_raw[38]
[147] conjugate_dnorm_dnorm_linear sampler: u1_raw[39]
[148] conjugate_dnorm_dnorm_linear sampler: u1_raw[40]
[149] conjugate_dnorm_dnorm_linear sampler: u1_raw[41]
[150] conjugate_dnorm_dnorm_linear sampler: u1_raw[42]
[151] conjugate_dnorm_dnorm_linear sampler: u1_raw[43]
[152] conjugate_dnorm_dnorm_linear sampler: u1_raw[44]
[153] conjugate_dnorm_dnorm_linear sampler: u1_raw[45]
[154] conjugate_dnorm_dnorm_linear sampler: u1_raw[46]
[155] conjugate_dnorm_dnorm_linear sampler: u1_raw[47]
[156] conjugate_dnorm_dnorm_linear sampler: u1_raw[48]
[157] conjugate_dnorm_dnorm_linear sampler: u1_raw[49]
[158] conjugate_dnorm_dnorm_linear sampler: u1_raw[50]
[159] conjugate_dnorm_dnorm_linear sampler: u1_raw[51]
[160] conjugate_dnorm_dnorm_linear sampler: u1_raw[52]
[161] conjugate_dnorm_dnorm_linear sampler: u1_raw[53]
[162] conjugate_dnorm_dnorm_linear sampler: u1_raw[54]
[163] conjugate_dnorm_dnorm_linear sampler: u1_raw[55]
[164] conjugate_dnorm_dnorm_linear sampler: u1_raw[56]
[165] conjugate_dnorm_dnorm_linear sampler: u1_raw[57]
[166] conjugate_dnorm_dnorm_linear sampler: u1_raw[58]
[167] conjugate_dnorm_dnorm_linear sampler: u1_raw[59]
[168] conjugate_dnorm_dnorm_linear sampler: u1_raw[60]
[169] conjugate_dnorm_dnorm_linear sampler: u1_raw[61]
[170] conjugate_dnorm_dnorm_linear sampler: u1_raw[62]
[171] conjugate_dnorm_dnorm_linear sampler: u1_raw[63]
[172] conjugate_dnorm_dnorm_linear sampler: u1_raw[64]
[173] conjugate_dnorm_dnorm_linear sampler: u1_raw[65]
[174] conjugate_dnorm_dnorm_linear sampler: u1_raw[66]
[175] conjugate_dnorm_dnorm_linear sampler: u1_raw[67]
[176] conjugate_dnorm_dnorm_linear sampler: u1_raw[68]
[177] conjugate_dnorm_dnorm_linear sampler: u1_raw[69]
[178] conjugate_dnorm_dnorm_linear sampler: u1_raw[70]
[179] conjugate_dnorm_dnorm_linear sampler: u1_raw[71]
[180] conjugate_dnorm_dnorm_linear sampler: u1_raw[72]
[181] conjugate_dnorm_dnorm_linear sampler: u1_raw[73]
[182] conjugate_dnorm_dnorm_linear sampler: u1_raw[74]
[183] conjugate_dnorm_dnorm_linear sampler: u1_raw[75]
[184] conjugate_dnorm_dnorm_linear sampler: u1_raw[76]
[185] conjugate_dnorm_dnorm_linear sampler: u1_raw[77]
[186] conjugate_dnorm_dnorm_linear sampler: u1_raw[78]
[187] conjugate_dnorm_dnorm_linear sampler: u1_raw[79]
[188] conjugate_dnorm_dnorm_linear sampler: u1_raw[80]
[189] conjugate_dnorm_dnorm_linear sampler: u1_raw[81]
[190] conjugate_dnorm_dnorm_linear sampler: u1_raw[82]
[191] conjugate_dnorm_dnorm_linear sampler: u1_raw[83]
[192] conjugate_dnorm_dnorm_linear sampler: u1_raw[84]
[193] conjugate_dnorm_dnorm_linear sampler: u1_raw[85]
[194] conjugate_dnorm_dnorm_linear sampler: u1_raw[86]
[195] conjugate_dnorm_dnorm_linear sampler: u1_raw[87]
[196] conjugate_dnorm_dnorm_linear sampler: u1_raw[88]
[197] conjugate_dnorm_dnorm_linear sampler: u1_raw[89]
[198] conjugate_dnorm_dnorm_linear sampler: u1_raw[90]
[199] conjugate_dnorm_dnorm_linear sampler: u1_raw[91]
[200] conjugate_dnorm_dnorm_linear sampler: u1_raw[92]
[201] conjugate_dnorm_dnorm_linear sampler: u1_raw[93]
[202] conjugate_dnorm_dnorm_linear sampler: u1_raw[94]
[203] conjugate_dnorm_dnorm_linear sampler: u1_raw[95]
[204] conjugate_dnorm_dnorm_linear sampler: u1_raw[96]
[205] conjugate_dnorm_dnorm_linear sampler: u1_raw[97]
[206] conjugate_dnorm_dnorm_linear sampler: u1_raw[98]
[207] conjugate_dnorm_dnorm_linear sampler: u1_raw[99]
[208] conjugate_dnorm_dnorm_linear sampler: u1_raw[100]
[209] RW sampler: sigma_residual
[210] conjugate_dnorm_dnorm_additive sampler: gamma_Intercept
[211] conjugate_dnorm_dnorm_linear sampler: gamma_z
[212] RW sampler: sigma_imputation
---------------------------------------------------------------------[ FAIL 0 | WARN 0 | SKIP 3 | PASS 1 ]

══ Skipped tests (3) ═══════════════════════════════════════════════════════════
• empty test (3): 'test-data_generation.R:1:1', 'test-model-fitting.R:1:1',
  'test-stage2_sampling.R:1:1'

[ FAIL 0 | WARN 0 | SKIP 3 | PASS 1 ]
> 
> proc.time()
   user  system elapsed 
 15.019   0.736  16.098 
