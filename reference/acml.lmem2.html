<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope) — acml.lmem2 • bayes2stage</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope) — acml.lmem2"><meta name="description" content="Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope)"><meta property="og:description" content="Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bayes2stage</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bayes2stage.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/maxdrohde/bayes2stage/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope)</h1>
      <small class="dont-index">Source: <a href="https://github.com/maxdrohde/bayes2stage/blob/master/R/acml_functions.R" class="external-link"><code>R/acml_functions.R</code></a></small>
      <div class="d-none name"><code>acml.lmem2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fitting function: ACML or WL for a linear mixed effects model (random intercept and slope)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">acml.lmem2</span><span class="op">(</span></span>
<span>  <span class="va">formula.fixed</span>,</span>
<span>  <span class="va">formula.random</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  w.function <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  <span class="va">InitVals</span>,</span>
<span>  <span class="va">cutpoints</span>,</span>
<span>  <span class="va">SampProb</span>,</span>
<span>  <span class="va">Weights</span>,</span>
<span>  ProfileCol <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula-fixed">formula.fixed<a class="anchor" aria-label="anchor" href="#arg-formula-fixed"></a></dt>
<dd><p>formula for the fixed effects (of the form y~x)</p></dd>


<dt id="arg-formula-random">formula.random<a class="anchor" aria-label="anchor" href="#arg-formula-random"></a></dt>
<dd><p>formula for the random effects (of the form ~z).  Right now this model only fits random intercept and slope models.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>data frame that should contain everything in formula.fixed, formula.random, id, and Weights.  It does not include: w.function, cutpoints, SampProb</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>sum(n_i) vector of subject ids (a variable contained in data)</p></dd>


<dt id="arg-w-function">w.function<a class="anchor" aria-label="anchor" href="#arg-w-function"></a></dt>
<dd><p>sum(n_i) vector with possible values that include "mean" (mean of response series), "intercept" (intercept of the regression of Yi ~ zi where zi is the design matrix for the random effects (solve(t.zi* zi) * t.zi)<code>[1,]</code>), "intercept1"  (intercept of the regression of Yi ~ zi where zi is the design matrix for the random effects (solve(t.zi * zi) * t.zi)<code>[1,]</code>). "intercept2" (second intercept of the regression of the Yi ~</p></dd>


<dt id="arg-initvals">InitVals<a class="anchor" aria-label="anchor" href="#arg-initvals"></a></dt>
<dd><p>starting values for c(beta, log(sigma0), log(sigma1), log((1+rho)/(1-rho)), log(sigmae))</p></dd>


<dt id="arg-cutpoints">cutpoints<a class="anchor" aria-label="anchor" href="#arg-cutpoints"></a></dt>
<dd><p>A matrix with the first dimension equal to sum(n_i).  These cutpoints define the sampling regions for individual subjects.  If using a low, medium, high, sampling scheme, this is a sum(n_i) by 2 matrix that must be a distinct object not contained in the dat dataframe.  Each row is a vector of length 2 c(k1,k2) to define the sampling regions, i.e., low, middle, high.  If using a square doughnut design this should be sum(n_i) by 4 matrix (var1lower, var1upper, var2lower, var2upper). Each subject should have n_i rows of the same values.</p></dd>


<dt id="arg-sampprob">SampProb<a class="anchor" aria-label="anchor" href="#arg-sampprob"></a></dt>
<dd><p>A matrix with the first dimension equal to sum(n_i).   Sampling probabilities from within each region. For low medium high sampling, each row is a vector of length 3 with sampling probabilities for each region. For bivariate stratum sampling each row is a vector of length 2 with sampling probabilities for the inner and outer strata. Each subject should have n_i rows of the same values.  Not in data.</p></dd>


<dt id="arg-weights">Weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Subject specific sampling weights.  A vector of length sum(n_i).  This should be a variable in the data dataframe. It should only be used if doing IPWL.  Note if doing IPWL, only use robcov (robust variances) and not covar.  If not doing IPWL, this must be a vectors of 1s.</p></dd>


<dt id="arg-profilecol">ProfileCol<a class="anchor" aria-label="anchor" href="#arg-profilecol"></a></dt>
<dd><p>the column number(s) for which we want fixed at the value of param.  Maximizing the log likelihood for all other parameters
while fixing these columns at the values of <code>InitVals[ProfileCol]</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Ascertainment corrected Maximum likelihood: Ests, covar, LogL, code, robcov</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maximilian Rohde.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

